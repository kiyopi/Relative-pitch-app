# ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ãƒ»ãƒªã‚½ãƒ¼ã‚¹ç®¡ç†ä»•æ§˜æ›¸

**ãƒãƒ¼ã‚¸ãƒ§ãƒ³**: 1.0.0
**ä½œæˆæ—¥**: 2025-10-22
**å¯¾è±¡**: PitchPro-SPAï¼ˆ8vaç›¸å¯¾éŸ³æ„Ÿãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ã‚¢ãƒ—ãƒªï¼‰

---

## ğŸ“‹ ç›®æ¬¡

1. [æ¦‚è¦](#æ¦‚è¦)
2. [ç”¨èªå®šç¾©](#ç”¨èªå®šç¾©)
3. [ç¾çŠ¶åˆ†æ](#ç¾çŠ¶åˆ†æ)
4. [ä»•æ§˜è¨­è¨ˆ](#ä»•æ§˜è¨­è¨ˆ)
5. [å®Ÿè£…è¨ˆç”»](#å®Ÿè£…è¨ˆç”»)
6. [ãƒ†ã‚¹ãƒˆä»•æ§˜](#ãƒ†ã‚¹ãƒˆä»•æ§˜)
7. [ä»˜éŒ²](#ä»˜éŒ²)

---

## æ¦‚è¦

### ç›®çš„

æœ¬ä»•æ§˜æ›¸ã¯ã€SPAã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«ãŠã‘ã‚‹ä»¥ä¸‹ã®3ã¤ã®ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ã‚·ãƒŠãƒªã‚ªã§ã®ãƒªã‚½ãƒ¼ã‚¹ç®¡ç†ãƒ»ãƒ‡ãƒ¼ã‚¿ä¿æŒãƒ»ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—å‡¦ç†ã‚’å®šç¾©ã™ã‚‹ã€‚

1. **ãƒ–ãƒ©ã‚¦ã‚¶ãƒªãƒ­ãƒ¼ãƒ‰**: ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒF5ã‚­ãƒ¼ã‚„ãƒªãƒ­ãƒ¼ãƒ‰ãƒœã‚¿ãƒ³ã§ãƒšãƒ¼ã‚¸ã‚’å†èª­ã¿è¾¼ã¿
2. **ãƒ–ãƒ©ã‚¦ã‚¶ãƒãƒƒã‚¯**: ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒãƒ–ãƒ©ã‚¦ã‚¶ã®æˆ»ã‚‹ãƒœã‚¿ãƒ³ã§å‰ãƒšãƒ¼ã‚¸ã«ç§»å‹•
3. **ãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã‚¢ã‚¯ã‚»ã‚¹**: ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒç‰¹å®šã®URLï¼ˆãƒãƒƒã‚·ãƒ¥ï¼‰ã‚’ç›´æ¥å…¥åŠ›ã—ã¦ã‚¢ã‚¯ã‚»ã‚¹

### èƒŒæ™¯ãƒ»èª²é¡Œ

#### ç™ºè¦‹ã•ã‚ŒãŸå•é¡Œç‚¹

**èª¿æŸ»æ—¥**: 2025-10-22
**å¯¾è±¡ç¯„å›²**: å…¨ãƒšãƒ¼ã‚¸ï¼ˆhome, preparation, training, result-session, results-overviewï¼‰

| å•é¡Œ | ãƒšãƒ¼ã‚¸ | æ·±åˆ»åº¦ | å½±éŸ¿ |
|------|--------|--------|------|
| ãƒªãƒ­ãƒ¼ãƒ‰æ™‚ã®ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—æœªå®Ÿè£… | training | ğŸ”´ é«˜ | ãƒªã‚½ãƒ¼ã‚¹ãƒªãƒ¼ã‚¯ã€ãƒ‡ãƒ¼ã‚¿æå¤± |
| ãƒ–ãƒ©ã‚¦ã‚¶ãƒãƒƒã‚¯æ™‚ã®ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—æœªå®Ÿè£… | training | ğŸ”´ é«˜ | ãƒªã‚½ãƒ¼ã‚¹ãƒªãƒ¼ã‚¯ã€ãƒ‡ãƒ¼ã‚¿æå¤± |
| éŸ³åŸŸæœªè¨­å®šæ™‚ã®ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°é–‹å§‹ | training | ğŸŸ¡ ä¸­ | UXä½ä¸‹ã€ä¸æ­£ç¢ºãªå‹•ä½œ |
| ä¸å®Œå…¨ãƒ‡ãƒ¼ã‚¿ã§ã®ç·åˆè©•ä¾¡è¡¨ç¤º | results-overview | ğŸŸ¡ ä¸­ | èª¤è§£ã‚’æ‹›ãè¡¨ç¤º |

#### ç¾åœ¨ã®å®Ÿè£…çŠ¶æ³

- **âœ… preparationãƒšãƒ¼ã‚¸**: ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—å®Ÿè£…æ¸ˆã¿ï¼ˆrouter.js:334-346ï¼‰
- **âŒ trainingãƒšãƒ¼ã‚¸**: ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—æœªå®Ÿè£…ï¼ˆrouter.js:350-354ã§ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆï¼‰
- **âš ï¸ å‰ææ¡ä»¶ãƒã‚§ãƒƒã‚¯**: ä¸€éƒ¨ãƒšãƒ¼ã‚¸ã§ä¸å®Œå…¨

---

## ç”¨èªå®šç¾©

### ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ã‚·ãƒŠãƒªã‚ª

| ç”¨èª | å®šç¾© | ãƒˆãƒªã‚¬ãƒ¼ | ã‚¤ãƒ™ãƒ³ãƒˆ |
|------|------|----------|----------|
| **ãƒ–ãƒ©ã‚¦ã‚¶ãƒªãƒ­ãƒ¼ãƒ‰** | ç¾åœ¨ã®ãƒšãƒ¼ã‚¸ã‚’å†èª­ã¿è¾¼ã¿ | F5ã‚­ãƒ¼ã€ãƒªãƒ­ãƒ¼ãƒ‰ãƒœã‚¿ãƒ³ã€`location.reload()` | `beforeunload`, `pagehide` |
| **ãƒ–ãƒ©ã‚¦ã‚¶ãƒãƒƒã‚¯** | å±¥æ­´ã‚’æˆ»ã‚‹ | æˆ»ã‚‹ãƒœã‚¿ãƒ³ã€Backspaceã€`history.back()` | `hashchange`, `popstate` |
| **ãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã‚¢ã‚¯ã‚»ã‚¹** | URLã‚’ç›´æ¥å…¥åŠ›ã—ã¦ã‚¢ã‚¯ã‚»ã‚¹ | ã‚¢ãƒ‰ãƒ¬ã‚¹ãƒãƒ¼å…¥åŠ›ã€ãƒ–ãƒƒã‚¯ãƒãƒ¼ã‚¯ã€å¤–éƒ¨ãƒªãƒ³ã‚¯ | `DOMContentLoaded`, `hashchange` |
| **é€šå¸¸é·ç§»** | ã‚¢ãƒ—ãƒªå†…ãƒªãƒ³ã‚¯ã§ã®é·ç§» | ãƒœã‚¿ãƒ³ã‚¯ãƒªãƒƒã‚¯ã€`window.location.hash` | `hashchange` |

### ãƒªã‚½ãƒ¼ã‚¹ç¨®åˆ¥

| ãƒªã‚½ãƒ¼ã‚¹ | èª¬æ˜ | è§£æ”¾æ–¹æ³• |
|----------|------|----------|
| **AudioDetector** | PitchProéŸ³å£°æ¤œå‡ºã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ | `stopDetection()`, `destroy()` |
| **MediaStream** | ãƒã‚¤ã‚¯å…¥åŠ›ã‚¹ãƒˆãƒªãƒ¼ãƒ  | `getTracks().forEach(track => track.stop())` |
| **PitchShifter** | Tone.jséŸ³æºå†ç”Ÿã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ | `dispose()`ï¼ˆå­˜åœ¨ã™ã‚‹å ´åˆï¼‰ |
| **SessionRecorder** | ã‚»ãƒƒã‚·ãƒ§ãƒ³ãƒ‡ãƒ¼ã‚¿è¨˜éŒ²ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ | `completeSession()` or `resetSession()` |
| **ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼** | DOMè¦ç´ ã«ç™»éŒ²ã•ã‚ŒãŸãƒªã‚¹ãƒŠãƒ¼ | `removeEventListener()` |

### ãƒ‡ãƒ¼ã‚¿çŠ¶æ…‹

| çŠ¶æ…‹ | å®šç¾© | å¯¾å¿œæ–¹é‡ |
|------|------|----------|
| **completed** | ã‚»ãƒƒã‚·ãƒ§ãƒ³å®Œäº†æ¸ˆã¿ | localStorageä¿å­˜æ¸ˆã¿ã€å¾©å…ƒä¸è¦ |
| **in-progress** | ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°å®Ÿè¡Œä¸­ | é€”ä¸­ãƒ‡ãƒ¼ã‚¿ä¿å­˜ or ç ´æ£„ |
| **not-started** | æœªé–‹å§‹ | åˆæœŸåŒ–ã®ã¿å¿…è¦ |

---

## ç¾çŠ¶åˆ†æ

### 1. ãƒ–ãƒ©ã‚¦ã‚¶ãƒªãƒ­ãƒ¼ãƒ‰

#### ç¾åœ¨ã®å‹•ä½œãƒ•ãƒ­ãƒ¼

```
ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ä¸­ã«ãƒªãƒ­ãƒ¼ãƒ‰å®Ÿè¡Œ
â†“
window.pagehide ã‚¤ãƒ™ãƒ³ãƒˆç™ºç«
â†“
router.cleanupCurrentPage() å‘¼ã³å‡ºã—
â†“
âŒ if (this.currentPage === 'training') ã®å‡¦ç†ãŒã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆ
â†“
preparationãƒšãƒ¼ã‚¸ã®ã¿ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—å®Ÿè¡Œ
â†“
ãƒšãƒ¼ã‚¸å®Œå…¨ãƒªãƒ­ãƒ¼ãƒ‰
â†“
SPAãƒ«ãƒ¼ã‚¿ãƒ¼åˆæœŸåŒ–
â†“
#training ãƒãƒƒã‚·ãƒ¥ã‚’æ¤œå‡º
â†“
trainingãƒšãƒ¼ã‚¸å†è¡¨ç¤ºï¼ˆæ–°è¦ã‚»ãƒƒã‚·ãƒ§ãƒ³é–‹å§‹ï¼‰
```

#### å•é¡Œç‚¹

| é …ç›® | ç¾åœ¨ã®çŠ¶æ…‹ | æœ›ã¾ã—ã„çŠ¶æ…‹ |
|------|-----------|-------------|
| AudioDetector | åœæ­¢ã•ã‚Œãªã„ | `stopDetection()` å‘¼ã³å‡ºã— |
| MediaStream | ãƒ–ãƒ©ã‚¦ã‚¶è‡ªå‹•è§£æ”¾ | æ˜ç¤ºçš„ã«`stop()`å‘¼ã³å‡ºã— |
| SessionRecorder.currentSession | ãƒ‡ãƒ¼ã‚¿å¤±ã‚ã‚Œã‚‹ | è‡ªå‹•ä¿å­˜ or ãƒ¦ãƒ¼ã‚¶ãƒ¼ç¢ºèª |
| ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ | ãƒ¡ãƒ¢ãƒªãƒªãƒ¼ã‚¯å¯èƒ½æ€§ | æ˜ç¤ºçš„å‰Šé™¤ |

#### å½±éŸ¿åº¦è©•ä¾¡

- **ãƒ‡ãƒ¼ã‚¿æå¤±**: âš ï¸ ä¸­ï½é«˜ï¼ˆãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°é€”ä¸­ã®pitchErrorsãƒ‡ãƒ¼ã‚¿ãŒå¤±ã‚ã‚Œã‚‹ï¼‰
- **ãƒªã‚½ãƒ¼ã‚¹ãƒªãƒ¼ã‚¯**: âš ï¸ ä½ï¼ˆãƒ–ãƒ©ã‚¦ã‚¶ãŒãƒšãƒ¼ã‚¸ãƒªãƒ­ãƒ¼ãƒ‰æ™‚ã«ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—ï¼‰
- **UXå½±éŸ¿**: âš ï¸ ä¸­ï¼ˆæ„å›³ã—ãªã„ãƒ‡ãƒ¼ã‚¿æå¤±ã§ãƒ¦ãƒ¼ã‚¶ãƒ¼ä¸æº€ï¼‰

---

### 2. ãƒ–ãƒ©ã‚¦ã‚¶ãƒãƒƒã‚¯

#### ç¾åœ¨ã®å‹•ä½œãƒ•ãƒ­ãƒ¼

```
ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ä¸­ã«ãƒ–ãƒ©ã‚¦ã‚¶ãƒãƒƒã‚¯å®Ÿè¡Œ
â†“
window.hashchange ã‚¤ãƒ™ãƒ³ãƒˆç™ºç«
â†“
router.handleRouteChange() å®Ÿè¡Œ
â†“
router.cleanupCurrentPage() å‘¼ã³å‡ºã—
â†“
âŒ trainingãƒšãƒ¼ã‚¸ã®ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—æœªå®Ÿè£…
â†“
å‰ã®ãƒšãƒ¼ã‚¸ï¼ˆhome or preparationãªã©ï¼‰è¡¨ç¤º
```

#### å•é¡Œç‚¹

ãƒªãƒ­ãƒ¼ãƒ‰æ™‚ã¨åŒã˜å•é¡ŒãŒç™ºç”Ÿã€‚ãŸã ã—ã€ãƒ–ãƒ©ã‚¦ã‚¶ãƒãƒƒã‚¯ã®å ´åˆã¯ä»¥ä¸‹ã®è¿½åŠ ãƒªã‚¹ã‚¯ã‚ã‚Šï¼š

- **æ¬¡ãƒšãƒ¼ã‚¸ã§ã®ãƒã‚¤ã‚¯ã‚¢ã‚¯ã‚»ã‚¹ç«¶åˆ**: preparationã«æˆ»ã£ãŸå ´åˆã€ãƒã‚¤ã‚¯ãŒæ—¢ã«ä½¿ç”¨ä¸­ã®å¯èƒ½æ€§
- **ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³å±¥æ­´ã®ä¸æ•´åˆ**: ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—å¤±æ•—ã«ã‚ˆã‚‹ãƒšãƒ¼ã‚¸çŠ¶æ…‹ã®ä¸ä¸€è‡´

---

### 3. ãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã‚¢ã‚¯ã‚»ã‚¹

#### å„ãƒšãƒ¼ã‚¸ã®å‰ææ¡ä»¶ãƒãƒˆãƒªãƒƒã‚¯ã‚¹

| ãƒšãƒ¼ã‚¸ | å¿…è¦ãªå‰ææ¡ä»¶ | ãƒã‚§ãƒƒã‚¯å®Ÿè£… | ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯å‡¦ç† | å•é¡Œç‚¹ |
|--------|---------------|-------------|-------------------|--------|
| **home** | ãªã— | - | - | ãªã— |
| **preparation** | ãƒã‚¤ã‚¯è¨±å¯ | âŒ ãªã— | åˆå›ã‚¢ã‚¯ã‚»ã‚¹æ™‚ã«è¦æ±‚ | æ‹’å¦æ™‚ã®å‡¦ç†ã¯æ­£è¦ç‰ˆã«å§”è­² |
| **training** | éŸ³åŸŸè¨­å®šã€ãƒã‚¤ã‚¯è¨±å¯ | âš ï¸ éƒ¨åˆ†çš„ | å…¨ç¯„å›²ä½¿ç”¨ | éŸ³åŸŸæœªè¨­å®šã§ã‚‚é–‹å§‹å¯èƒ½ |
| **result-session** | å¯¾è±¡ã‚»ãƒƒã‚·ãƒ§ãƒ³ãƒ‡ãƒ¼ã‚¿ | âœ… ã‚ã‚Š | æœ€æ–°ã‚»ãƒƒã‚·ãƒ§ãƒ³ä½¿ç”¨ | è‰¯å¥½ |
| **results-overview** | 8ã‚»ãƒƒã‚·ãƒ§ãƒ³å®Œäº† | âš ï¸ ä¸å®Œå…¨ | ãƒ€ãƒŸãƒ¼ãƒ‡ãƒ¼ã‚¿è¡¨ç¤º | æœªå®Œäº†ã§ã‚‚è¡¨ç¤º |

#### å•é¡Œã®è©³ç´°

##### training ãƒšãƒ¼ã‚¸

**ç¾åœ¨ã®å®Ÿè£…** (trainingController.js:704-707):
```javascript
if (!voiceRangeData || !voiceRangeData.results) {
    console.warn('âš ï¸ éŸ³åŸŸãƒ‡ãƒ¼ã‚¿ãªã— - å…¨ç¯„å›²ã‚’ä½¿ç”¨');
    return allNotes; // C2-C6ã®å…¨ç¯„å›²
}
```

**å•é¡Œ**:
- ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®å£°åŸŸã‚’è¶…ãˆã‚‹åŸºéŸ³ï¼ˆä¾‹: C2 65.4Hzï¼‰ãŒé¸ã°ã‚Œã‚‹å¯èƒ½æ€§
- å‰å›ã®ã‚»ãƒƒã‚·ãƒ§ãƒ³ã§-700Â¢ã®å¤§å¹…ãªèª¤å·®ãŒç™ºç”Ÿã—ãŸåŸå› ã¨åŒã˜

**å½±éŸ¿**:
- éŸ³ç¨‹æ¤œå‡ºã®ä¸æ­£ç¢ºã•
- ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®æ··ä¹±ãƒ»ä¸æº€
- ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°åŠ¹æœã®ä½ä¸‹

##### results-overview ãƒšãƒ¼ã‚¸

**ç¾åœ¨ã®å®Ÿè£…** (results-overview.html:395-399):
```javascript
if (!sessionData || sessionData.length === 0) {
    console.warn('âš ï¸ ã‚»ãƒƒã‚·ãƒ§ãƒ³ãƒ‡ãƒ¼ã‚¿ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã€‚ãƒ€ãƒŸãƒ¼ãƒ‡ãƒ¼ã‚¿ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚');
    showDummyOverview();
    return;
}
// 8ã‚»ãƒƒã‚·ãƒ§ãƒ³å®Œäº†ãƒã‚§ãƒƒã‚¯ãªã—
```

**å•é¡Œ**:
- 2-3ã‚»ãƒƒã‚·ãƒ§ãƒ³ã§ã‚‚ã€Œç·åˆè©•ä¾¡ã€ã¨ã—ã¦è¡¨ç¤º
- ãƒšãƒ¼ã‚¸ã‚¿ã‚¤ãƒˆãƒ«ã«ã€Œ8ã‚»ãƒƒã‚·ãƒ§ãƒ³ (64éŸ³) ã®ç·åˆè©•ä¾¡ã€ã¨è¡¨ç¤ºã•ã‚Œã‚‹ãŒå®Ÿéš›ã¯æœªå®Œäº†

**å½±éŸ¿**:
- èª¤è§£ã‚’æ‹›ãè¡¨ç¤º
- ä¸å®Œå…¨ãªã‚°ãƒ¬ãƒ¼ãƒ‰è©•ä¾¡
- ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®æ··ä¹±

---

## ä»•æ§˜è¨­è¨ˆ

### è¨­è¨ˆåŸå‰‡

1. **æ˜ç¤ºçš„ãƒªã‚½ãƒ¼ã‚¹ç®¡ç†**: ã™ã¹ã¦ã®ãƒªã‚½ãƒ¼ã‚¹ã¯æ˜ç¤ºçš„ã«å–å¾—ãƒ»è§£æ”¾ã™ã‚‹
2. **ãƒ¦ãƒ¼ã‚¶ãƒ¼å„ªå…ˆ**: ãƒ‡ãƒ¼ã‚¿æå¤±æ™‚ã¯ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ç¢ºèªã‚’æ±‚ã‚ã‚‹
3. **é˜²å¾¡çš„ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°**: å‰ææ¡ä»¶ãŒæº€ãŸã•ã‚Œãªã„å ´åˆã¯å®‰å…¨ãªå‹•ä½œã‚’ä¿è¨¼
4. **ä¸€è²«æ€§**: å…¨ãƒšãƒ¼ã‚¸ã§çµ±ä¸€ã•ã‚ŒãŸã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’ä½¿ç”¨

---

### 1. ãƒªãƒ­ãƒ¼ãƒ‰æ™‚ã®å‡¦ç†ä»•æ§˜

#### æ–¹é‡

ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ä¸­ã®ãƒªãƒ­ãƒ¼ãƒ‰ã¯**ãƒ‡ãƒ¼ã‚¿æå¤±ã‚’ä¼´ã†ç ´å£Šçš„æ“ä½œ**ã¨ã—ã¦æ‰±ã†ã€‚

#### ä»•æ§˜

##### A. beforeunloadè­¦å‘Šï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰

**å®Ÿè£…å ´æ‰€**: trainingController.js

```javascript
// ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ä¸­ã®ã¿æœ‰åŠ¹åŒ–
let isTrainingActive = false;

window.addEventListener('beforeunload', (e) => {
    if (isTrainingActive && sessionRecorder.getCurrentSession()) {
        e.preventDefault();
        e.returnValue = ''; // Chromeç­‰ã§ãƒ€ã‚¤ã‚¢ãƒ­ã‚°è¡¨ç¤º
        return ''; // ä¸€éƒ¨ãƒ–ãƒ©ã‚¦ã‚¶ç”¨
    }
});
```

**æ³¨æ„**:
- Chromeç­‰ã§ã¯æ±ç”¨ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®ã¿è¡¨ç¤ºã•ã‚Œã‚‹
- ã‚«ã‚¹ã‚¿ãƒ ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã¯è¡¨ç¤ºã§ããªã„
- iOS Safariã§ã¯å‹•ä½œã—ãªã„å¯èƒ½æ€§ã‚ã‚Š

**åˆ¤æ–­**: ã“ã®æ©Ÿèƒ½ã¯**ã‚ªãƒ—ã‚·ãƒ§ãƒ³å®Ÿè£…**ã¨ã—ã€æœ€åˆã¯å®Ÿè£…ã—ãªã„

##### B. pagehideã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—ï¼ˆå¿…é ˆï¼‰

**å®Ÿè£…å ´æ‰€**: router.js

```javascript
async cleanupCurrentPage() {
    try {
        // preparationãƒšãƒ¼ã‚¸ï¼ˆæ—¢å­˜å®Ÿè£…ï¼‰
        if (this.currentPage === 'preparation') {
            console.log('Cleaning up preparation page resources...');
            if (typeof window.preparationManager !== 'undefined' && window.preparationManager) {
                await window.preparationManager.cleanupPitchPro();
            }
            if (typeof window.resetPreparationPageFlag === 'function') {
                window.resetPreparationPageFlag();
            }
        }

        // trainingãƒšãƒ¼ã‚¸ï¼ˆæ–°è¦å®Ÿè£…ï¼‰
        if (this.currentPage === 'training') {
            console.log('Cleaning up training page resources...');

            // éŸ³å£°æ¤œå‡ºåœæ­¢
            if (window.audioDetector) {
                console.log('ğŸ›‘ AudioDetectoråœæ­¢ä¸­...');
                window.audioDetector.stopDetection();
            }

            // ãƒã‚¤ã‚¯ã‚¹ãƒˆãƒªãƒ¼ãƒ æ˜ç¤ºçš„è§£æ”¾
            if (window.audioStream) {
                console.log('ğŸ¤ ãƒã‚¤ã‚¯ã‚¹ãƒˆãƒªãƒ¼ãƒ è§£æ”¾ä¸­...');
                window.audioStream.getTracks().forEach(track => track.stop());
                window.audioStream = null;
            }

            // PitchShifteråœæ­¢ï¼ˆãƒ¡ã‚½ãƒƒãƒ‰ãŒå­˜åœ¨ã™ã‚‹å ´åˆï¼‰
            if (window.pitchShifterInstance) {
                console.log('ğŸ¹ PitchShifteråœæ­¢ä¸­...');
                if (typeof window.pitchShifterInstance.dispose === 'function') {
                    window.pitchShifterInstance.dispose();
                }
                window.pitchShifterInstance = null;
            }

            // ã‚»ãƒƒã‚·ãƒ§ãƒ³ãƒ‡ãƒ¼ã‚¿å‡¦ç†
            if (window.sessionDataRecorder) {
                const currentSession = window.sessionDataRecorder.getCurrentSession();
                if (currentSession && !currentSession.completed) {
                    console.warn('âš ï¸ æœªå®Œäº†ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚ã‚Š - é€”ä¸­ãƒ‡ãƒ¼ã‚¿ã¯ç ´æ£„ã•ã‚Œã¾ã™');
                    // ä»Šå¾Œã®å®Ÿè£…: è‡ªå‹•ä¿å­˜æ©Ÿèƒ½ã‚’è¿½åŠ ã™ã‚‹å ´åˆã¯ã“ã“ã§ä¿å­˜
                }
                window.sessionDataRecorder.resetSession();
            }

            // åˆæœŸåŒ–ãƒ•ãƒ©ã‚°ãƒªã‚»ãƒƒãƒˆ
            if (typeof window.resetTrainingPageFlag === 'function') {
                window.resetTrainingPageFlag();
            }

            console.log('âœ… Training page cleanup complete');
        }

    } catch (error) {
        console.warn('Page cleanup error:', error);
        // ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—ã‚¨ãƒ©ãƒ¼ã¯è­¦å‘Šãƒ¬ãƒ™ãƒ«ã§ç¶šè¡Œ
    }
}
```

##### C. ãƒªãƒ­ãƒ¼ãƒ‰å¾Œã®å¾©å¸°å‹•ä½œ

**ä»•æ§˜**:
- ãƒªãƒ­ãƒ¼ãƒ‰å¾Œã¯**æ–°è¦ã‚»ãƒƒã‚·ãƒ§ãƒ³**ã¨ã—ã¦é–‹å§‹
- é€”ä¸­ãƒ‡ãƒ¼ã‚¿ã®å¾©å…ƒã¯è¡Œã‚ãªã„ï¼ˆå°†æ¥çš„ãªæ‹¡å¼µã¨ã—ã¦æ¤œè¨å¯èƒ½ï¼‰
- ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼ã¯ç¶™ç¶šï¼ˆlocalStorageä¿å­˜æ¸ˆã¿ï¼‰

---

### 2. ãƒ–ãƒ©ã‚¦ã‚¶ãƒãƒƒã‚¯æ™‚ã®å‡¦ç†ä»•æ§˜

#### æ–¹é‡

ãƒ–ãƒ©ã‚¦ã‚¶ãƒãƒƒã‚¯ã¯**æ„å›³çš„ãªãƒšãƒ¼ã‚¸é›¢è„±**ã¨ã—ã¦æ‰±ã„ã€ãƒªãƒ­ãƒ¼ãƒ‰æ™‚ã¨åŒã˜ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—ã‚’å®Ÿè¡Œã€‚

#### ä»•æ§˜

##### A. hashchangeæ™‚ã®ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—

**å®Ÿè£…å ´æ‰€**: router.js

```javascript
async handleRouteChange() {
    const hash = window.location.hash.substring(1) || 'home';
    const page = hash.split('?')[0];

    console.log('ğŸ” [Router] Route changed to:', page);

    try {
        // ç¾åœ¨ã®ãƒšãƒ¼ã‚¸ã®ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—ï¼ˆãƒ–ãƒ©ã‚¦ã‚¶ãƒãƒƒã‚¯æ™‚ã‚‚å®Ÿè¡Œï¼‰
        await this.cleanupCurrentPage();

        await this.loadPage(page, hash);
    } catch (error) {
        console.error('Route loading error:', error);
        await this.loadPage('home');
    }
}
```

**æ—¢å­˜å®Ÿè£…ã®ç¢ºèª**:
- âœ… æ—¢ã«å®Ÿè£…æ¸ˆã¿ï¼ˆrouter.js:55-56ï¼‰
- `cleanupCurrentPage()` ãŒtrainingãƒšãƒ¼ã‚¸ã«å¯¾å¿œã™ã‚Œã°è‡ªå‹•çš„ã«å¯¾å¿œå®Œäº†

##### B. ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³å±¥æ­´ã®æ•´åˆæ€§

**ä»•æ§˜**:
- ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—å®Œäº†å¾Œã«å‰ãƒšãƒ¼ã‚¸ã¸é·ç§»
- å‰ãƒšãƒ¼ã‚¸ã§å¿…è¦ãªãƒªã‚½ãƒ¼ã‚¹ï¼ˆãƒã‚¤ã‚¯ç­‰ï¼‰ã¯å†åˆæœŸåŒ–

---

### 3. ãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã‚¢ã‚¯ã‚»ã‚¹æ™‚ã®å‡¦ç†ä»•æ§˜

#### æ–¹é‡

å„ãƒšãƒ¼ã‚¸ã§**å‰ææ¡ä»¶ã‚’å³æ ¼ã«ãƒã‚§ãƒƒã‚¯**ã—ã€æº€ãŸã•ã‚Œãªã„å ´åˆã¯é©åˆ‡ãªãƒšãƒ¼ã‚¸ã«ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã€‚

#### ä»•æ§˜ãƒãƒˆãƒªãƒƒã‚¯ã‚¹

| ãƒšãƒ¼ã‚¸ | ãƒã‚§ãƒƒã‚¯é …ç›® | ä¸æº€è¶³æ™‚ã®å‹•ä½œ | å®Ÿè£…å„ªå…ˆåº¦ |
|--------|-------------|---------------|-----------|
| home | - | - | - |
| preparation | - | - | ğŸŸ¢ ç¾çŠ¶ç¶­æŒ |
| training | éŸ³åŸŸè¨­å®š | homeã«ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ + ã‚¢ãƒ©ãƒ¼ãƒˆ | ğŸ”´ å¿…é ˆ |
| result-session | ã‚»ãƒƒã‚·ãƒ§ãƒ³ãƒ‡ãƒ¼ã‚¿ | æœ€æ–°ã‚»ãƒƒã‚·ãƒ§ãƒ³ä½¿ç”¨ or ãƒ€ãƒŸãƒ¼è¡¨ç¤º | ğŸŸ¢ ç¾çŠ¶ç¶­æŒ |
| results-overview | 8ã‚»ãƒƒã‚·ãƒ§ãƒ³å®Œäº† | trainingã«ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ + ã‚¢ãƒ©ãƒ¼ãƒˆ | ğŸŸ¡ æ¨å¥¨ |

#### è©³ç´°ä»•æ§˜

##### A. training ãƒšãƒ¼ã‚¸

**å®Ÿè£…å ´æ‰€**: trainingController.js

```javascript
export async function initializeTrainingPage() {
    console.log('ğŸš€ TrainingController initializing...');

    // ã€æ–°è¦è¿½åŠ ã€‘éŸ³åŸŸãƒ‡ãƒ¼ã‚¿å¿…é ˆãƒã‚§ãƒƒã‚¯
    if (!checkVoiceRangeData()) {
        console.error('âŒ éŸ³åŸŸãƒ‡ãƒ¼ã‚¿ãŒè¨­å®šã•ã‚Œã¦ã„ã¾ã›ã‚“');
        showErrorAndRedirect(
            'éŸ³åŸŸãƒ†ã‚¹ãƒˆã‚’å…ˆã«å®Œäº†ã—ã¦ãã ã•ã„ã€‚',
            'preparation'
        );
        return;
    }

    // æ—¢å­˜ã®åˆæœŸåŒ–å‡¦ç†...
    if (isInitialized) {
        console.log('TrainingController already initialized, resetting...');
    }

    // ... ä»¥ä¸‹æ—¢å­˜ã‚³ãƒ¼ãƒ‰ ...
}

/**
 * éŸ³åŸŸãƒ‡ãƒ¼ã‚¿ã®å­˜åœ¨ã¨å¦¥å½“æ€§ã‚’ãƒã‚§ãƒƒã‚¯
 * @returns {boolean} ãƒ‡ãƒ¼ã‚¿ãŒæœ‰åŠ¹ãªå ´åˆtrue
 */
function checkVoiceRangeData() {
    loadVoiceRangeData();

    if (!voiceRangeData || !voiceRangeData.results) {
        return false;
    }

    // comfortableRangeã®å­˜åœ¨ç¢ºèª
    const rangeData = voiceRangeData.results.comfortableRange || voiceRangeData.results;
    if (!rangeData.lowFreq || !rangeData.highFreq) {
        return false;
    }

    // ã‚ªã‚¯ã‚¿ãƒ¼ãƒ–æ•°ãŒ1ä»¥ä¸Šã‹ç¢ºèª
    const octaves = Math.log2(rangeData.highFreq / rangeData.lowFreq);
    if (octaves < 1.0) {
        console.warn(`âš ï¸ ã‚ªã‚¯ã‚¿ãƒ¼ãƒ–æ•°ä¸è¶³: ${octaves.toFixed(2)}ã‚ªã‚¯ã‚¿ãƒ¼ãƒ–ï¼ˆ1.0ä»¥ä¸Šå¿…è¦ï¼‰`);
        return false;
    }

    return true;
}

/**
 * ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤ºã—ã¦ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ
 * @param {string} message - ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
 * @param {string} redirectTo - ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆå…ˆãƒãƒƒã‚·ãƒ¥
 */
function showErrorAndRedirect(message, redirectTo) {
    // ãƒ¢ãƒ¼ãƒ€ãƒ«ãƒ€ã‚¤ã‚¢ãƒ­ã‚°è¡¨ç¤ºï¼ˆå°†æ¥çš„ã«ã¯ã‚«ã‚¹ã‚¿ãƒ UIã«å¤‰æ›´å¯èƒ½ï¼‰
    alert(message);

    // ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ
    window.location.hash = redirectTo;
}
```

##### B. results-overview ãƒšãƒ¼ã‚¸

**å®Ÿè£…å ´æ‰€**: results-overview.html

```javascript
async function initResultsOverview() {
    console.log('ğŸ“Š ç·åˆè©•ä¾¡ãƒšãƒ¼ã‚¸åˆæœŸåŒ–é–‹å§‹');

    // DataManagerã‹ã‚‰å…¨ã‚»ãƒƒã‚·ãƒ§ãƒ³ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—
    const sessionData = loadAllSessionData();

    // ã€å¤‰æ›´ã€‘ãƒ‡ãƒ¼ã‚¿å­˜åœ¨ãƒã‚§ãƒƒã‚¯å¼·åŒ–
    if (!sessionData || sessionData.length === 0) {
        console.error('âŒ ã‚»ãƒƒã‚·ãƒ§ãƒ³ãƒ‡ãƒ¼ã‚¿ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“');
        showErrorAndRedirect(
            'ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ã‚’é–‹å§‹ã—ã¦ãã ã•ã„ã€‚',
            'home'
        );
        return;
    }

    // ã€æ–°è¦è¿½åŠ ã€‘8ã‚»ãƒƒã‚·ãƒ§ãƒ³å®Œäº†ãƒã‚§ãƒƒã‚¯
    const randomModeSessions = sessionData.filter(s => s.mode === 'random' && s.completed);
    if (randomModeSessions.length < 8) {
        console.warn(`âš ï¸ ã‚»ãƒƒã‚·ãƒ§ãƒ³æœªå®Œäº†: ${randomModeSessions.length}/8ã‚»ãƒƒã‚·ãƒ§ãƒ³`);
        showErrorAndRedirect(
            `8ã‚»ãƒƒã‚·ãƒ§ãƒ³å®Œäº†å¾Œã«ç·åˆè©•ä¾¡ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚\nç¾åœ¨: ${randomModeSessions.length}/8ã‚»ãƒƒã‚·ãƒ§ãƒ³å®Œäº†`,
            'training'
        );
        return;
    }

    console.log('âœ… ã‚»ãƒƒã‚·ãƒ§ãƒ³ãƒ‡ãƒ¼ã‚¿å–å¾—:', randomModeSessions);

    // å‹•çš„ã‚°ãƒ¬ãƒ¼ãƒ‰è¨ˆç®—
    const evaluation = window.EvaluationCalculator.calculateDynamicGrade(randomModeSessions);
    console.log('âœ… è©•ä¾¡çµæœ:', evaluation);

    // UIæ›´æ–°
    updateOverviewUI(evaluation, randomModeSessions);

    // Chart.jsåˆæœŸåŒ–
    if (typeof Chart !== 'undefined') {
        initializeCharts(randomModeSessions);
    }

    // Lucideã‚¢ã‚¤ã‚³ãƒ³å†åˆæœŸåŒ–
    if (typeof lucide !== 'undefined') {
        lucide.createIcons();
    }
}

/**
 * ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤ºã—ã¦ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ
 * @param {string} message - ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
 * @param {string} redirectTo - ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆå…ˆãƒãƒƒã‚·ãƒ¥
 */
function showErrorAndRedirect(message, redirectTo) {
    alert(message);
    window.location.hash = redirectTo;
}
```

---

## å®Ÿè£…è¨ˆç”»

### ãƒ•ã‚§ãƒ¼ã‚º1: å¿…é ˆå®Ÿè£…ï¼ˆå„ªå…ˆåº¦: ğŸ”´ é«˜ï¼‰

**ç›®æ¨™**: trainingãƒšãƒ¼ã‚¸ã®ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—ã¨ãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡ã‚’å®Ÿè£…

#### ã‚¿ã‚¹ã‚¯1-1: router.jsã®ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—å®Ÿè£…

**ãƒ•ã‚¡ã‚¤ãƒ«**: `/PitchPro-SPA/js/router.js`

**å¤‰æ›´ç®‡æ‰€**: `cleanupCurrentPage()` ãƒ¡ã‚½ãƒƒãƒ‰ï¼ˆ330-360è¡Œï¼‰

**å®Ÿè£…å†…å®¹**:
```javascript
// 350-354è¡Œã®ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆã‚’è§£é™¤ã—ã€å®Ÿè£…ã‚’è¿½åŠ 
if (this.currentPage === 'training') {
    console.log('Cleaning up training page resources...');

    // AudioDetectoråœæ­¢
    if (window.audioDetector) {
        console.log('ğŸ›‘ AudioDetectoråœæ­¢ä¸­...');
        window.audioDetector.stopDetection();
    }

    // ãƒã‚¤ã‚¯ã‚¹ãƒˆãƒªãƒ¼ãƒ è§£æ”¾
    if (window.audioStream) {
        console.log('ğŸ¤ ãƒã‚¤ã‚¯ã‚¹ãƒˆãƒªãƒ¼ãƒ è§£æ”¾ä¸­...');
        window.audioStream.getTracks().forEach(track => track.stop());
        window.audioStream = null;
    }

    // PitchShifteråœæ­¢
    if (window.pitchShifterInstance) {
        console.log('ğŸ¹ PitchShifteråœæ­¢ä¸­...');
        if (typeof window.pitchShifterInstance.dispose === 'function') {
            window.pitchShifterInstance.dispose();
        }
        window.pitchShifterInstance = null;
    }

    // ã‚»ãƒƒã‚·ãƒ§ãƒ³ãƒ‡ãƒ¼ã‚¿å‡¦ç†
    if (window.sessionDataRecorder) {
        const currentSession = window.sessionDataRecorder.getCurrentSession();
        if (currentSession && !currentSession.completed) {
            console.warn('âš ï¸ æœªå®Œäº†ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚ã‚Š - é€”ä¸­ãƒ‡ãƒ¼ã‚¿ã¯ç ´æ£„ã•ã‚Œã¾ã™');
        }
        window.sessionDataRecorder.resetSession();
    }

    // åˆæœŸåŒ–ãƒ•ãƒ©ã‚°ãƒªã‚»ãƒƒãƒˆ
    if (typeof window.resetTrainingPageFlag === 'function') {
        window.resetTrainingPageFlag();
    }

    console.log('âœ… Training page cleanup complete');
}
```

**ãƒ†ã‚¹ãƒˆé …ç›®**:
- [ ] ãƒªãƒ­ãƒ¼ãƒ‰æ™‚ã«ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—ãƒ­ã‚°ãŒè¡¨ç¤ºã•ã‚Œã‚‹
- [ ] AudioDetectorãŒåœæ­¢ã•ã‚Œã‚‹
- [ ] ãƒã‚¤ã‚¯ã‚¢ã‚¯ã‚»ã‚¹ãƒ©ãƒ³ãƒ—ãŒæ¶ˆç¯ã™ã‚‹
- [ ] ãƒ¡ãƒ¢ãƒªãƒªãƒ¼ã‚¯ãŒç™ºç”Ÿã—ãªã„

#### ã‚¿ã‚¹ã‚¯1-2: trainingãƒšãƒ¼ã‚¸ã®å‰ææ¡ä»¶ãƒã‚§ãƒƒã‚¯

**ãƒ•ã‚¡ã‚¤ãƒ«**: `/PitchPro-SPA/js/controllers/trainingController.js`

**å¤‰æ›´ç®‡æ‰€**: `initializeTrainingPage()` é–¢æ•°ã®å…ˆé ­ï¼ˆ10-30è¡Œä»˜è¿‘ï¼‰

**å®Ÿè£…å†…å®¹**:
```javascript
export async function initializeTrainingPage() {
    console.log('ğŸš€ TrainingController initializing...');

    // ã€æ–°è¦è¿½åŠ ã€‘éŸ³åŸŸãƒ‡ãƒ¼ã‚¿å¿…é ˆãƒã‚§ãƒƒã‚¯
    if (!checkVoiceRangeData()) {
        console.error('âŒ éŸ³åŸŸãƒ‡ãƒ¼ã‚¿ãŒè¨­å®šã•ã‚Œã¦ã„ã¾ã›ã‚“');
        alert('éŸ³åŸŸãƒ†ã‚¹ãƒˆã‚’å…ˆã«å®Œäº†ã—ã¦ãã ã•ã„ã€‚');
        window.location.hash = 'preparation';
        return;
    }

    // æ—¢å­˜ã®åˆæœŸåŒ–å‡¦ç†...
    // ...
}

// ã€æ–°è¦è¿½åŠ ã€‘éŸ³åŸŸãƒ‡ãƒ¼ã‚¿ãƒã‚§ãƒƒã‚¯é–¢æ•°
function checkVoiceRangeData() {
    loadVoiceRangeData();

    if (!voiceRangeData || !voiceRangeData.results) {
        return false;
    }

    const rangeData = voiceRangeData.results.comfortableRange || voiceRangeData.results;
    if (!rangeData.lowFreq || !rangeData.highFreq) {
        return false;
    }

    const octaves = Math.log2(rangeData.highFreq / rangeData.lowFreq);
    if (octaves < 1.0) {
        console.warn(`âš ï¸ ã‚ªã‚¯ã‚¿ãƒ¼ãƒ–æ•°ä¸è¶³: ${octaves.toFixed(2)}ã‚ªã‚¯ã‚¿ãƒ¼ãƒ–ï¼ˆ1.0ä»¥ä¸Šå¿…è¦ï¼‰`);
        return false;
    }

    return true;
}
```

**ãƒ†ã‚¹ãƒˆé …ç›®**:
- [ ] éŸ³åŸŸæœªè¨­å®šæ™‚ã«preparationã«ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã•ã‚Œã‚‹
- [ ] ã‚¢ãƒ©ãƒ¼ãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¡¨ç¤ºã•ã‚Œã‚‹
- [ ] éŸ³åŸŸè¨­å®šå¾Œã¯æ­£å¸¸ã«ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ãŒé–‹å§‹ã•ã‚Œã‚‹

#### ã‚¿ã‚¹ã‚¯1-3: resetTrainingPageFlagé–¢æ•°ã®è¿½åŠ 

**ãƒ•ã‚¡ã‚¤ãƒ«**: `/PitchPro-SPA/js/controllers/trainingController.js`

**è¿½åŠ ç®‡æ‰€**: ãƒ•ã‚¡ã‚¤ãƒ«æœ«å°¾ï¼ˆexportå®£è¨€ä»˜è¿‘ï¼‰

**å®Ÿè£…å†…å®¹**:
```javascript
/**
 * ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ãƒšãƒ¼ã‚¸ã®åˆæœŸåŒ–ãƒ•ãƒ©ã‚°ã‚’ãƒªã‚»ãƒƒãƒˆ
 * router.jsã®cleanupCurrentPage()ã‹ã‚‰å‘¼ã³å‡ºã•ã‚Œã‚‹
 */
export function resetTrainingPageFlag() {
    console.log('ğŸ”„ Training page flag reset');
    isInitialized = false;
}

// ã‚°ãƒ­ãƒ¼ãƒãƒ«ã«å…¬é–‹ï¼ˆrouter.jsã‹ã‚‰å‘¼ã³å‡ºã—å¯èƒ½ã«ã™ã‚‹ï¼‰
window.resetTrainingPageFlag = resetTrainingPageFlag;
```

**ãƒ†ã‚¹ãƒˆé …ç›®**:
- [ ] ãƒªãƒ­ãƒ¼ãƒ‰å¾Œã«å†åˆæœŸåŒ–ãŒæ­£ã—ãå®Ÿè¡Œã•ã‚Œã‚‹
- [ ] ãƒ•ãƒ©ã‚°ãƒªã‚»ãƒƒãƒˆã®ãƒ­ã‚°ãŒè¡¨ç¤ºã•ã‚Œã‚‹

---

### ãƒ•ã‚§ãƒ¼ã‚º2: æ¨å¥¨å®Ÿè£…ï¼ˆå„ªå…ˆåº¦: ğŸŸ¡ ä¸­ï¼‰

**ç›®æ¨™**: results-overviewãƒšãƒ¼ã‚¸ã®å‰ææ¡ä»¶ãƒã‚§ãƒƒã‚¯ã‚’å®Ÿè£…

#### ã‚¿ã‚¹ã‚¯2-1: 8ã‚»ãƒƒã‚·ãƒ§ãƒ³å®Œäº†ãƒã‚§ãƒƒã‚¯

**ãƒ•ã‚¡ã‚¤ãƒ«**: `/PitchPro-SPA/pages/results-overview.html`

**å¤‰æ›´ç®‡æ‰€**: `initResultsOverview()` é–¢æ•°ï¼ˆ389-419è¡Œï¼‰

**å®Ÿè£…å†…å®¹**:
```javascript
async function initResultsOverview() {
    console.log('ğŸ“Š ç·åˆè©•ä¾¡ãƒšãƒ¼ã‚¸åˆæœŸåŒ–é–‹å§‹');

    const sessionData = loadAllSessionData();

    // ãƒ‡ãƒ¼ã‚¿å­˜åœ¨ãƒã‚§ãƒƒã‚¯
    if (!sessionData || sessionData.length === 0) {
        console.error('âŒ ã‚»ãƒƒã‚·ãƒ§ãƒ³ãƒ‡ãƒ¼ã‚¿ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“');
        alert('ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ã‚’é–‹å§‹ã—ã¦ãã ã•ã„ã€‚');
        window.location.hash = 'home';
        return;
    }

    // ã€æ–°è¦è¿½åŠ ã€‘8ã‚»ãƒƒã‚·ãƒ§ãƒ³å®Œäº†ãƒã‚§ãƒƒã‚¯
    const randomModeSessions = sessionData.filter(s => s.mode === 'random' && s.completed);
    if (randomModeSessions.length < 8) {
        console.warn(`âš ï¸ ã‚»ãƒƒã‚·ãƒ§ãƒ³æœªå®Œäº†: ${randomModeSessions.length}/8ã‚»ãƒƒã‚·ãƒ§ãƒ³`);
        alert(`8ã‚»ãƒƒã‚·ãƒ§ãƒ³å®Œäº†å¾Œã«ç·åˆè©•ä¾¡ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚\nç¾åœ¨: ${randomModeSessions.length}/8ã‚»ãƒƒã‚·ãƒ§ãƒ³å®Œäº†`);
        window.location.hash = 'training';
        return;
    }

    console.log('âœ… ã‚»ãƒƒã‚·ãƒ§ãƒ³ãƒ‡ãƒ¼ã‚¿å–å¾—:', randomModeSessions);

    // å‹•çš„ã‚°ãƒ¬ãƒ¼ãƒ‰è¨ˆç®—ï¼ˆrandomModeSessionsã‚’ä½¿ç”¨ï¼‰
    const evaluation = window.EvaluationCalculator.calculateDynamicGrade(randomModeSessions);
    console.log('âœ… è©•ä¾¡çµæœ:', evaluation);

    // UIæ›´æ–°ï¼ˆrandomModeSessionsã‚’ä½¿ç”¨ï¼‰
    updateOverviewUI(evaluation, randomModeSessions);

    // Chart.jsåˆæœŸåŒ–ï¼ˆrandomModeSessionsã‚’ä½¿ç”¨ï¼‰
    if (typeof Chart !== 'undefined') {
        initializeCharts(randomModeSessions);
    }

    // Lucideã‚¢ã‚¤ã‚³ãƒ³å†åˆæœŸåŒ–
    if (typeof lucide !== 'undefined') {
        lucide.createIcons();
    }
}
```

**ãƒ†ã‚¹ãƒˆé …ç›®**:
- [ ] æœªå®Œäº†æ™‚ã«trainingã«ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã•ã‚Œã‚‹
- [ ] ã‚¢ãƒ©ãƒ¼ãƒˆã«å®Œäº†ã‚»ãƒƒã‚·ãƒ§ãƒ³æ•°ãŒè¡¨ç¤ºã•ã‚Œã‚‹
- [ ] 8ã‚»ãƒƒã‚·ãƒ§ãƒ³å®Œäº†å¾Œã¯æ­£å¸¸ã«è¡¨ç¤ºã•ã‚Œã‚‹

---

### ãƒ•ã‚§ãƒ¼ã‚º3: å°†æ¥çš„ãªæ‹¡å¼µï¼ˆå„ªå…ˆåº¦: ğŸŸ¢ ä½ï¼‰

**ç›®æ¨™**: UXæ”¹å–„ã¨é«˜åº¦ãªæ©Ÿèƒ½å®Ÿè£…

#### ã‚¿ã‚¹ã‚¯3-1: beforeunloadè­¦å‘Šã®å®Ÿè£…

**ä»•æ§˜**:
- ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ä¸­ã®ãƒªãƒ­ãƒ¼ãƒ‰æ™‚ã«è­¦å‘Šãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã‚’è¡¨ç¤º
- ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«æ“ä½œã®ç¢ºèªã‚’æ±‚ã‚ã‚‹

**æ³¨æ„**:
- iOS Safariã§ã¯å‹•ä½œã—ãªã„
- Chromeç­‰ã§ã¯æ±ç”¨ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®ã¿è¡¨ç¤º

#### ã‚¿ã‚¹ã‚¯3-2: ã‚»ãƒƒã‚·ãƒ§ãƒ³ãƒ‡ãƒ¼ã‚¿è‡ªå‹•ä¿å­˜

**ä»•æ§˜**:
- ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ä¸­ã®ãƒªãƒ­ãƒ¼ãƒ‰/ãƒ–ãƒ©ã‚¦ã‚¶ãƒãƒƒã‚¯æ™‚ã«é€”ä¸­ãƒ‡ãƒ¼ã‚¿ã‚’è‡ªå‹•ä¿å­˜
- æ¬¡å›ã‚¢ã‚¯ã‚»ã‚¹æ™‚ã«ã€Œå‰å›ã®ç¶šãã‹ã‚‰é–‹å§‹ã—ã¾ã™ã‹ï¼Ÿã€ã¨ç¢ºèª

**å®Ÿè£…**:
```javascript
// sessionDataRecorder.js ã«è¿½åŠ 
saveIncompleteSession() {
    if (this.currentSession && !this.currentSession.completed) {
        const incompleteData = {
            ...this.currentSession,
            incompleteFlag: true,
            savedAt: Date.now()
        };
        localStorage.setItem('incompleteSession', JSON.stringify(incompleteData));
        console.log('ğŸ’¾ é€”ä¸­ãƒ‡ãƒ¼ã‚¿è‡ªå‹•ä¿å­˜:', incompleteData);
    }
}
```

#### ã‚¿ã‚¹ã‚¯3-3: ã‚«ã‚¹ã‚¿ãƒ ã‚¨ãƒ©ãƒ¼ãƒ€ã‚¤ã‚¢ãƒ­ã‚°

**ä»•æ§˜**:
- `alert()`ã®ä»£ã‚ã‚Šã«ã‚«ã‚¹ã‚¿ãƒ ãƒ¢ãƒ¼ãƒ€ãƒ«ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã‚’ä½¿ç”¨
- ã‚ˆã‚Šè¦–è¦šçš„ã«åˆ†ã‹ã‚Šã‚„ã™ã„UI

---

## ãƒ†ã‚¹ãƒˆä»•æ§˜

### ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ä¸€è¦§

#### T-1: ãƒªãƒ­ãƒ¼ãƒ‰æ™‚ã®ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—

| ID | ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ | æ‰‹é † | æœŸå¾…çµæœ |
|----|-------------|------|----------|
| T-1-1 | ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°é–‹å§‹å‰ãƒªãƒ­ãƒ¼ãƒ‰ | 1. trainingãƒšãƒ¼ã‚¸è¡¨ç¤º<br>2. ãƒªãƒ­ãƒ¼ãƒ‰å®Ÿè¡Œ | ã‚¨ãƒ©ãƒ¼ãªãå†è¡¨ç¤º |
| T-1-2 | ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ä¸­ãƒªãƒ­ãƒ¼ãƒ‰ | 1. åŸºéŸ³ã‚¹ã‚¿ãƒ¼ãƒˆ<br>2. 2-3éŸ³æ­Œå”±<br>3. ãƒªãƒ­ãƒ¼ãƒ‰å®Ÿè¡Œ | ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—ãƒ­ã‚°è¡¨ç¤ºã€ãƒã‚¤ã‚¯æ¶ˆç¯ |
| T-1-3 | ã‚»ãƒƒã‚·ãƒ§ãƒ³å®Œäº†å¾Œãƒªãƒ­ãƒ¼ãƒ‰ | 1. 8éŸ³å®Œäº†<br>2. çµæœãƒšãƒ¼ã‚¸è¡¨ç¤ºå‰ã«ãƒªãƒ­ãƒ¼ãƒ‰ | æ­£å¸¸ã«trainingãƒšãƒ¼ã‚¸å†è¡¨ç¤º |

#### T-2: ãƒ–ãƒ©ã‚¦ã‚¶ãƒãƒƒã‚¯æ™‚ã®ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—

| ID | ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ | æ‰‹é † | æœŸå¾…çµæœ |
|----|-------------|------|----------|
| T-2-1 | ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ä¸­ã«homeã¸æˆ»ã‚‹ | 1. åŸºéŸ³ã‚¹ã‚¿ãƒ¼ãƒˆ<br>2. ãƒ–ãƒ©ã‚¦ã‚¶ãƒãƒƒã‚¯ | ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—å®Ÿè¡Œã€homeãƒšãƒ¼ã‚¸è¡¨ç¤º |
| T-2-2 | ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ä¸­ã«preparationã¸æˆ»ã‚‹ | 1. åŸºéŸ³ã‚¹ã‚¿ãƒ¼ãƒˆ<br>2. ãƒ–ãƒ©ã‚¦ã‚¶ãƒãƒƒã‚¯ | ãƒã‚¤ã‚¯ç«¶åˆãªã—ã€preparationãƒšãƒ¼ã‚¸æ­£å¸¸å‹•ä½œ |

#### T-3: ãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡

| ID | ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ | æ‰‹é † | æœŸå¾…çµæœ |
|----|-------------|------|----------|
| T-3-1 | éŸ³åŸŸæœªè¨­å®šã§trainingã‚¢ã‚¯ã‚»ã‚¹ | 1. localStorageå‰Šé™¤<br>2. #trainingã‚¢ã‚¯ã‚»ã‚¹ | ã‚¢ãƒ©ãƒ¼ãƒˆè¡¨ç¤ºã€preparationã«ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ |
| T-3-2 | éŸ³åŸŸè¨­å®šæ¸ˆã¿ã§trainingã‚¢ã‚¯ã‚»ã‚¹ | 1. éŸ³åŸŸè¨­å®šå®Œäº†<br>2. #trainingã‚¢ã‚¯ã‚»ã‚¹ | æ­£å¸¸ã«ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°é–‹å§‹ |
| T-3-3 | æœªå®Œäº†ã§results-overviewã‚¢ã‚¯ã‚»ã‚¹ | 1. 2ã‚»ãƒƒã‚·ãƒ§ãƒ³å®Œäº†<br>2. #results-overviewã‚¢ã‚¯ã‚»ã‚¹ | ã‚¢ãƒ©ãƒ¼ãƒˆè¡¨ç¤ºã€trainingã«ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ |
| T-3-4 | å®Œäº†å¾Œã«results-overviewã‚¢ã‚¯ã‚»ã‚¹ | 1. 8ã‚»ãƒƒã‚·ãƒ§ãƒ³å®Œäº†<br>2. #results-overviewã‚¢ã‚¯ã‚»ã‚¹ | æ­£å¸¸ã«ç·åˆè©•ä¾¡è¡¨ç¤º |

#### T-4: ãƒ¡ãƒ¢ãƒªãƒªãƒ¼ã‚¯ç¢ºèª

| ID | ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ | æ‰‹é † | æœŸå¾…çµæœ |
|----|-------------|------|----------|
| T-4-1 | è¤‡æ•°å›ã®ãƒªãƒ­ãƒ¼ãƒ‰ | 1. trainingãƒšãƒ¼ã‚¸è¡¨ç¤º<br>2. ãƒªãƒ­ãƒ¼ãƒ‰10å›å®Ÿè¡Œ<br>3. DevToolsã§ãƒ¡ãƒ¢ãƒªç¢ºèª | ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡ãŒå¢—åŠ ã—ç¶šã‘ãªã„ |
| T-4-2 | è¤‡æ•°å›ã®ãƒšãƒ¼ã‚¸é·ç§» | 1. homeâ†’trainingâ†’home ã‚’10å›ç¹°ã‚Šè¿”ã—<br>2. ãƒ¡ãƒ¢ãƒªç¢ºèª | ãƒ¡ãƒ¢ãƒªãƒªãƒ¼ã‚¯ãªã— |

---

### ãƒ†ã‚¹ãƒˆç’°å¢ƒ

#### ãƒ‡ãƒã‚¤ã‚¹ãƒ»ãƒ–ãƒ©ã‚¦ã‚¶ãƒãƒˆãƒªãƒƒã‚¯ã‚¹

| ãƒ‡ãƒã‚¤ã‚¹ | ãƒ–ãƒ©ã‚¦ã‚¶ | ãƒãƒ¼ã‚¸ãƒ§ãƒ³ | ãƒ†ã‚¹ãƒˆå„ªå…ˆåº¦ |
|---------|---------|-----------|-------------|
| PC (macOS) | Chrome | æœ€æ–° | ğŸ”´ å¿…é ˆ |
| PC (macOS) | Safari | æœ€æ–° | ğŸŸ¡ æ¨å¥¨ |
| iPhone | Safari | iOS 15+ | ğŸ”´ å¿…é ˆ |
| iPad | Safari | iPadOS 13+ | ğŸŸ¡ æ¨å¥¨ |

#### ãƒ†ã‚¹ãƒˆæ‰‹é †æ›¸

**æº–å‚™**:
1. ãƒ–ãƒ©ã‚¦ã‚¶ã®DevToolsã‚’é–‹ãï¼ˆConsole, Network, Memory ã‚¿ãƒ–ï¼‰
2. localStorageã‚’ã‚¯ãƒªã‚¢: `localStorage.clear()`
3. ãƒšãƒ¼ã‚¸ãƒªãƒ­ãƒ¼ãƒ‰: `location.reload()`

**å®Ÿè¡Œ**:
1. å„ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ã‚’é †ç•ªã«å®Ÿè¡Œ
2. Consoleãƒ­ã‚°ã‚’ç¢ºèª
3. æœŸå¾…çµæœã¨ä¸€è‡´ã™ã‚‹ã‹æ¤œè¨¼

**è¨˜éŒ²**:
- ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆ
- Consoleãƒ­ã‚°ã®ãƒ†ã‚­ã‚¹ãƒˆä¿å­˜
- ãƒ¡ãƒ¢ãƒªãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆT-4ç³»ã®ã¿ï¼‰

---

## ä»˜éŒ²

### A. å‚è€ƒãƒ•ã‚¡ã‚¤ãƒ«ä¸€è¦§

| ãƒ•ã‚¡ã‚¤ãƒ« | ãƒ‘ã‚¹ | ä¸»è¦ãªå½¹å‰² |
|---------|------|-----------|
| router.js | `/PitchPro-SPA/js/router.js` | SPAãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã€ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—ç®¡ç† |
| trainingController.js | `/PitchPro-SPA/js/controllers/trainingController.js` | ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ãƒšãƒ¼ã‚¸åˆ¶å¾¡ |
| preparationController.js | `/PitchPro-SPA/js/controllers/preparationController.js` | éŸ³åŸŸãƒ†ã‚¹ãƒˆãƒšãƒ¼ã‚¸åˆ¶å¾¡ |
| session-data-recorder.js | `/PitchPro-SPA/js/controllers/session-data-recorder.js` | ã‚»ãƒƒã‚·ãƒ§ãƒ³ãƒ‡ãƒ¼ã‚¿è¨˜éŒ² |
| result-session-controller.js | `/PitchPro-SPA/pages/js/result-session-controller.js` | ã‚»ãƒƒã‚·ãƒ§ãƒ³çµæœãƒšãƒ¼ã‚¸åˆ¶å¾¡ |
| results-overview.html | `/PitchPro-SPA/pages/results-overview.html` | ç·åˆè©•ä¾¡ãƒšãƒ¼ã‚¸ï¼ˆã‚¤ãƒ³ãƒ©ã‚¤ãƒ³JSï¼‰ |

### B. é–¢é€£ä»•æ§˜æ›¸

- `APP_SPECIFICATION.md`: ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ä»•æ§˜æ›¸
- `TRAINING_FLOW_SPECIFICATION.md`: ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ãƒ•ãƒ­ãƒ¼ä»•æ§˜æ›¸
- `DATA_MANAGEMENT_SPECIFICATION.md`: ãƒ‡ãƒ¼ã‚¿ç®¡ç†ä»•æ§˜æ›¸

### C. ã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•°ä¸€è¦§

| å¤‰æ•°å | å‹ | å®šç¾©å ´æ‰€ | ç”¨é€” |
|--------|---|---------|------|
| `window.audioDetector` | AudioDetectionComponent | trainingController.js | éŸ³å£°æ¤œå‡ºã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ |
| `window.audioStream` | MediaStream | trainingController.js | ãƒã‚¤ã‚¯å…¥åŠ›ã‚¹ãƒˆãƒªãƒ¼ãƒ  |
| `window.pitchShifterInstance` | PitchShifter | router.js | éŸ³æºå†ç”Ÿã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ |
| `window.sessionDataRecorder` | SessionDataRecorder | session-data-recorder.js | ã‚»ãƒƒã‚·ãƒ§ãƒ³ãƒ‡ãƒ¼ã‚¿è¨˜éŒ² |
| `window.voiceRangeData` | Object | trainingController.js | éŸ³åŸŸè¨­å®šãƒ‡ãƒ¼ã‚¿ |

### D. ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ä¸€è¦§

| ã‚¤ãƒ™ãƒ³ãƒˆ | ç™»éŒ²å ´æ‰€ | ãƒãƒ³ãƒ‰ãƒ©ãƒ¼ | ç”¨é€” |
|---------|---------|-----------|------|
| `hashchange` | router.js | `handleRouteChange()` | ãƒšãƒ¼ã‚¸é·ç§»æ¤œå‡º |
| `beforeunload` | router.js | ç©ºé–¢æ•° | åŒæœŸã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—ç”¨ï¼ˆç¾åœ¨æœªä½¿ç”¨ï¼‰ |
| `pagehide` | router.js | `cleanupCurrentPage()` | éåŒæœŸã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—å®Ÿè¡Œ |
| `DOMContentLoaded` | router.js | `handleRouteChange()` | åˆæœŸãƒšãƒ¼ã‚¸è¡¨ç¤º |

---

## æ”¹è¨‚å±¥æ­´

| ãƒãƒ¼ã‚¸ãƒ§ãƒ³ | æ—¥ä»˜ | å¤‰æ›´å†…å®¹ | æ‹…å½“è€… |
|-----------|------|---------|--------|
| 1.0.0 | 2025-10-22 | åˆç‰ˆä½œæˆ | Claude |

---

**END OF SPECIFICATION**
