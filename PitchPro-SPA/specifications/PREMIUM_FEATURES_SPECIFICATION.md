# 有料プラン機能仕様書 - Premium Features Specification

**バージョン**: 1.0.0
**作成日**: 2025-10-27
**用途**: 有料プラン価値検証・機能設計・実装ロードマップ

---

## 📊 有料プラン価値検証サマリー

### 🎯 検証結論

#### ✅ 現在の練習方法は科学的に有益である

**検証根拠**:
1. **科学的設計**: 相対音感の原則を完全遵守（基音音名隠蔽・相対音程訓練）
2. **段階的難易度**: 初級8回→中級12回→上級24回の明確な設計
3. **測定精度**: 外れ値率8.3%を達成（95%以上の信頼性）
4. **音域適応**: ユーザー固有の音域内で無理のない練習

**実データによる効果検証**:
```
外れ値率の推移:
初期実装: 30.2%
PitchPro設定最適化後: 17.7% (-41.4%改善)
倍音補正追加後: 8.3% (-72.5%改善)

C3倍音問題の解決:
修正前: 100%外れ値（全音が倍音誤検出）
修正後: 12.5%外れ値（87.5%改善）
```

#### ✅ 有料プランとして十分な価値がある

**競合優位性**:
| 比較項目 | 本アプリ | Perfect Ear | EarMaster | ヤマハ音楽教室 |
|---------|---------|------------|-----------|--------------|
| 月額料金 | **¥480** | ¥600 | ¥1,200 | ¥8,000+ |
| 相対音感特化 | ✅ | ❌ | △ | ✅ |
| 音域適応型 | ✅ | ❌ | ❌ | ✅ |
| 詳細分析 | ✅ | △ | ✅ | ✅ |
| 弱点克服モード | ✅ | ❌ | ❌ | ✅ |

**価格優位性**: 音楽教室の**1/16**、競合アプリの**半額〜2/3**

#### ⚠️ 改善が必要な点

**現状の不足機能**:
1. **データ活用不足**: 音程別・基音別の詳細分析なし
2. **弱点克服機能なし**: 分析結果を練習に活かせない
3. **長期成長可視化なし**: 3ヶ月履歴グラフ等の実装必要

---

## 💰 収益化戦略

### 価格設定

```typescript
const pricingTiers = {
  free: {
    price: "¥0",
    features: [
      "ランダム・連続モード利用可能",
      "1日3セッション制限",
      "直近7日分履歴",
      "基本評価表示のみ",
      "広告表示あり"
    ]
  },

  premium: {
    price: "¥480/月 または ¥4,800/年（2ヶ月分お得）",
    features: [
      "全モード無制限利用",
      "12音階モード使用可能",
      "弱点克服モード（新機能）",
      "詳細分析レポート",
      "音程別・基音別習熟度マップ",
      "3ヶ月成長履歴グラフ",
      "AI練習プラン自動生成",
      "結果のPDF/CSV出力",
      "広告完全除去",
      "優先サポート"
    ]
  },

  singlePurchase: {
    detailedReport: {
      price: "¥580/回",
      description: "詳細分析レポート単発購入"
    }
  }
};
```

### 無料版と有料版の明確な差別化

| 機能カテゴリ | 無料版 | 有料版（¥480/月） |
|------------|-------|-----------------|
| **トレーニングモード** | ランダム・連続のみ | **全モード** |
| **セッション制限** | 1日3セッション | **無制限** |
| **弱点克服モード** | 検出のみ表示 | **専用モード利用可** |
| **履歴保存** | 直近7日分 | **無制限保存** |
| **評価表示** | 基本評価のみ | **詳細分析** |
| **音程別分析** | なし | **2度〜8度個別分析** |
| **基音別分析** | なし | **12音習熟度マップ** |
| **傾向分析** | なし | **シャープ/フラット傾向** |
| **成長グラフ** | なし | **3ヶ月履歴グラフ** |
| **AI練習プラン** | なし | **自動生成** |
| **エクスポート** | なし | **PDF/CSV出力** |
| **広告** | あり | **完全除去** |

### 収益予測（12ヶ月後）

```typescript
const revenueProjection = {
  userMetrics: {
    totalUsers: 10000,
    dailyActiveUsers: 500,
    premiumConversionRate: 0.03,  // 3%
    premiumSubscribers: 300
  },

  monthlyRevenue: {
    premiumSubscriptions: "300人 × ¥480 = ¥144,000",
    advertising: "500DAU × ¥2/日 × 30日 = ¥30,000",
    affiliateCommissions: "¥20,000",
    educationLicensing: "¥75,000（3-5校）",
    total: "¥269,000/月"
  },

  annualRevenue: "¥3,228,000",
  netProfit: "¥165,800/月（年間 ¥1,989,600）"
};
```

---

## 🎯 実装が必要な機能

### Phase 1: データ活用基盤の強化（最優先）

#### 1.1 音程別集計機能

**目的**: 2度〜8度の個別習熟度を可視化

**データ構造**:
```typescript
interface IntervalAnalysis {
  interval: '2度' | '3度' | '4度' | '5度' | '6度' | '7度' | '8度';
  avgError: number;          // 平均誤差（セント）
  successRate: number;       // 成功率（0-1）
  count: number;             // 測定回数
  excellentCount: number;    // Excellent判定数（±10¢以内）
  goodCount: number;         // Good判定数（±25¢以内）
  passCount: number;         // Pass判定数（±50¢以内）
}

// 実装例
const intervalAnalysis: IntervalAnalysis[] = [
  { interval: '2度', avgError: 22, successRate: 0.75, count: 24, excellentCount: 6, goodCount: 12, passCount: 18 },
  { interval: '3度', avgError: 18, successRate: 0.85, count: 24, excellentCount: 10, goodCount: 18, passCount: 20 },
  // ... 8度まで
];
```

**UI表示**:
```
音程別精度分析
━━━━━━━━━━━━━━━━━━━━━━━━━━━
2度（レ）   平均誤差: ±22¢   成功率: 75%
           ████████████░░░░ 24回測定

3度（ミ）   平均誤差: ±18¢   成功率: 85%
           ██████████████░░ 24回測定

...
━━━━━━━━━━━━━━━━━━━━━━━━━━━
🎯 得意TOP3: 5度（ソ）、4度（ファ）、3度（ミ）
⚠️ 苦手TOP3: 2度（レ）、7度（シ）、6度（ラ）
```

#### 1.2 基音別習熟度マップ

**目的**: 12音それぞれの基音での習熟度を可視化

**データ構造**:
```typescript
interface BaseNoteAnalysis {
  baseNote: string;          // 'C3', 'C#3', 'D3', ... 'B3'
  avgError: number;          // 平均誤差（セント）
  sessionCount: number;      // セッション数
  successRate: number;       // 成功率（0-1）
  lastPracticed: Date;       // 最終練習日
}

// 12音律完全マップ
const baseNoteMap: BaseNoteAnalysis[] = [
  { baseNote: 'C3', avgError: 20, sessionCount: 5, successRate: 0.85, lastPracticed: new Date('2025-01-27') },
  { baseNote: 'C#3', avgError: 28, sessionCount: 3, successRate: 0.70, lastPracticed: new Date('2025-01-25') },
  { baseNote: 'D3', avgError: 22, sessionCount: 4, successRate: 0.80, lastPracticed: new Date('2025-01-26') },
  { baseNote: 'F#3', avgError: 35, sessionCount: 2, successRate: 0.60, lastPracticed: new Date('2025-01-20') }, // ← 弱点検出
  // ... B3まで
];
```

**UI表示（12音律ヒートマップ）**:
```
基音別習熟度マップ
━━━━━━━━━━━━━━━━━━━━━━━━━━━
C   C#  D   D#  E   F   F#  G   G#  A   A#  B
🟢  🟡  🟢  🟡  🟢  🟢  🔴  🟢  🟡  🟢  🟡  🟡

🟢 習得済み（±25¢以内）
🟡 練習中（±35¢以内）
🔴 要強化（±35¢以上）

⚠️ F#基音での成績が他より18¢低い傾向
   → 弱点克服モードで集中練習を推奨
```

#### 1.3 長期履歴保存（無制限）

**目的**: 3ヶ月以上の成長パターンを可視化

**データ構造**:
```typescript
interface HistoricalData {
  date: Date;
  mode: 'random' | 'continuous' | '12tone';
  avgError: number;
  successRate: number;
  sessionCount: number;
}

// 日付別集計
const dailyStats: HistoricalData[] = [
  { date: new Date('2025-01-01'), mode: 'random', avgError: 35, successRate: 0.60, sessionCount: 2 },
  { date: new Date('2025-01-02'), mode: 'random', avgError: 32, successRate: 0.65, sessionCount: 3 },
  // ... 90日分以上
];
```

**UI表示（成長グラフ）**:
```
3ヶ月成長グラフ
━━━━━━━━━━━━━━━━━━━━━━━━━━━
平均誤差（セント）
40¢ ┤
35¢ ┤●─●
30¢ ┤     ●─●─●
25¢ ┤           ●─●─●
20¢ ┤                 ●─●─●
    └────────────────────────
    11月  12月  1月   2月   3月

📈 継続的な改善傾向を確認
   平均誤差: 35¢ → 20¢（42%改善）

🎯 このペースで継続すればA級達成まで約1ヶ月
```

---

### Phase 2: 弱点克服モードの実装（新機能）

#### 2.1 弱点自動検出エンジン

**検出ロジック**:
```typescript
interface WeaknessDetection {
  // 音程別弱点検出
  weakIntervals: {
    interval: string;
    avgError: number;
    deviation: number;  // 他の音程との偏差
  }[];

  // 基音別弱点検出
  weakBaseNotes: {
    baseNote: string;
    avgError: number;
    deviation: number;  // 他の基音との偏差
  }[];

  // 傾向分析
  tendencies: {
    sharpBias: number;    // シャープ傾向（%）
    flatBias: number;     // フラット傾向（%）
    ascendingWeakness: boolean;  // 上行音程の苦手
    descendingWeakness: boolean; // 下行音程の苦手
  };
}

// 検出例
const detectedWeakness: WeaknessDetection = {
  weakIntervals: [
    { interval: '2度', avgError: 35, deviation: +15 },  // 他より15¢悪い
    { interval: '6度', avgError: 32, deviation: +12 }
  ],
  weakBaseNotes: [
    { baseNote: 'F#3', avgError: 38, deviation: +18 },  // 他より18¢悪い
    { baseNote: 'A#3', avgError: 35, deviation: +15 }
  ],
  tendencies: {
    sharpBias: 62,  // 62%がシャープ傾向
    flatBias: 38,
    ascendingWeakness: false,
    descendingWeakness: true  // 下行音程が苦手
  }
};
```

#### 2.2 弱点克服モードの設計

**モード仕様**:
```typescript
interface WeaknessOvercomeMode {
  // モード設定
  modeType: 'interval_focus' | 'basenote_focus' | 'tendency_correction';

  // 集中練習対象
  targetIntervals?: string[];      // 例: ['2度', '6度']
  targetBaseNotes?: string[];      // 例: ['F#3', 'A#3']
  targetTendency?: 'sharp' | 'flat' | 'ascending' | 'descending';

  // 練習設定
  sessionCount: 8 | 12 | 24;
  focusedRepetition: boolean;      // 苦手を繰り返し練習
  adaptiveDifficulty: boolean;     // 上達に応じて難易度調整

  // 成果測定
  improvementTracking: {
    before: {
      avgError: number;
      successRate: number;
    };
    current: {
      avgError: number;
      successRate: number;
    };
    improvement: string;  // 例: "+40%改善"
  };
}
```

**ユーザーフロー**:
```
【STEP 1】総合評価後に弱点を自動検出
━━━━━━━━━━━━━━━━━━━━━━━━━━━
トレーニング完了！

📊 総合評価: B級
   平均誤差: ±28セント

⚠️ 弱点が検出されました
━━━━━━━━━━━━━━━━━━━━━━━━━━━
🔴 F#基音での成績が他より18¢低い
   平均誤差: 38¢（他の基音: 20¢）

🔴 2度（レ）の音程精度が低い
   平均誤差: 35¢（他の音程: 20¢）

【STEP 2】弱点克服モードを提案
━━━━━━━━━━━━━━━━━━━━━━━━━━━
💪 弱点克服モードで集中練習しませんか？

推奨プラン1: F#基音集中練習（8セッション）
推奨プラン2: 2度音程集中練習（8セッション）
推奨プラン3: F# + 2度 統合練習（12セッション）

[プラン1を開始] [プラン2を開始] [後で]

【STEP 3】集中練習を実施
━━━━━━━━━━━━━━━━━━━━━━━━━━━
弱点克服モード
F#基音集中練習 - セッション 1/8

すべてのセッションでF#を基音として練習します
━━━━━━━━━━━━━━━━━━━━━━━━━━━

（通常のトレーニングと同じUI）

【STEP 4】改善効果を可視化
━━━━━━━━━━━━━━━━━━━━━━━━━━━
🎉 弱点克服モード完了！

F#基音の改善結果
━━━━━━━━━━━━━━━━━━━━━━━━━━━
練習前: 平均誤差 38¢、成功率 60%
練習後: 平均誤差 25¢、成功率 82%

📈 改善率: +36%向上
   誤差: -13¢改善
   成功率: +22%向上

🎯 他の基音との差が縮まりました！
   全体的な精度向上が期待できます。

[もう一度練習] [別の弱点に挑戦] [ホームへ]
```

#### 2.3 無料版と有料版の差別化

**無料版**:
```
⚠️ 弱点が検出されました

🔴 F#基音での成績が他より18¢低い傾向

💎 プレミアムで弱点克服モードを利用できます
   → F#基音を集中的に練習して克服

[プレミアムを見る] [後で]
```

**有料版**:
```
⚠️ 弱点が検出されました

🔴 F#基音での成績が他より18¢低い傾向

💪 弱点克服モードで集中練習できます

[F#集中練習を開始（8セッション）]
[カスタム練習プランを作成]
```

---

### Phase 3: プレミアム分析ページの実装

#### 3.1 音程精度分析タブ

**表示内容**:
```
音程精度分析
━━━━━━━━━━━━━━━━━━━━━━━━━━━

【音程別詳細分析】
2度（レ）  平均誤差: ±22¢  成功率: 75%  測定回数: 24回
          ████████████░░░░
          Excellent: 6回  Good: 12回  Pass: 18回

3度（ミ）  平均誤差: ±18¢  成功率: 85%  測定回数: 24回
          ██████████████░░
          Excellent: 10回  Good: 18回  Pass: 20回
...

【シャープ/フラット傾向】
シャープ傾向: 62%  ████████████░░░░░░░
フラット傾向: 38%  ████████░░░░░░░░░░░

【上行/下行音程比較】
上行音程:  平均誤差 ±20¢  ████████████████
下行音程:  平均誤差 ±28¢  ████████████░░░░

【TOP 3】
🏆 得意音程:  5度（ソ）±15¢  4度（ファ）±17¢  3度（ミ）±18¢
⚠️ 苦手音程:  2度（レ）±35¢  7度（シ）±32¢  6度（ラ）±28¢
```

#### 3.2 エラーパターン分析タブ

**表示内容**:
```
エラーパターン分析
━━━━━━━━━━━━━━━━━━━━━━━━━━━

【音程拡大/圧縮パターン】
2度: +12¢の拡大傾向（本来200¢ → 実際212¢）
6度: -8¢の圧縮傾向（本来900¢ → 実際892¢）

【音域別精度傾向】
低音域（C3-E3）:  平均誤差 ±25¢
中音域（F3-A3）:  平均誤差 ±20¢  ← 最も精度が高い
高音域（A#3-C4）: 平均誤差 ±28¢

【セッション別エラー履歴】
セッション1（C3）:  平均誤差 ±22¢  成功率 80%
セッション2（D3）:  平均誤差 ±20¢  成功率 85%
セッション3（F#3）: 平均誤差 ±38¢  成功率 60%  ⚠️
...
```

#### 3.3 AI練習プランタブ

**表示内容**:
```
AI練習プラン
━━━━━━━━━━━━━━━━━━━━━━━━━━━

あなたの分析結果から最適な練習プランを生成しました

【優先度: 高】
🔴 F#基音の集中練習
   理由: 他の基音より18¢低い精度
   推奨: 週3回・1回8セッション
   期待効果: 2週間で±10¢改善見込み

🔴 2度音程の精密練習
   理由: +12¢の拡大傾向が顕著
   推奨: 毎日5分・2度のみ反復練習
   期待効果: 1週間で±5¢改善見込み

【優先度: 中】
🟡 下行音程の強化
   理由: 上行より8¢悪い傾向
   推奨: 週2回・下降パターン練習
   期待効果: 3週間で上行レベルに到達

【優先度: 低】
🟢 高音域の精度向上
   理由: 中音域より8¢悪い
   推奨: 週1回・高音域ボイストレーニング併用

【成長予測】
現在のペースで継続すると...
📈 1ヶ月後: B級 → A級達成可能性 85%
📈 3ヶ月後: A級 → S級達成可能性 60%
```

#### 3.4 成長記録タブ

**表示内容**:
```
成長記録
━━━━━━━━━━━━━━━━━━━━━━━━━━━

【3ヶ月成長グラフ】
平均誤差（セント）
40¢ ┤
35¢ ┤●─●
30¢ ┤     ●─●─●
25¢ ┤           ●─●─●
20¢ ┤                 ●─●─●
    └────────────────────────
    11月  12月  1月   2月   3月

【マイルストーン】
✅ 2024-11-15  トレーニング開始
✅ 2024-12-01  C級達成（平均誤差 35¢）
✅ 2024-12-20  B級達成（平均誤差 28¢）
✅ 2025-01-10  A級達成（平均誤差 20¢）
🎯 2025-02-05  S級達成予測

【総練習時間】
累計セッション数: 156回
累計練習時間: 13時間25分
連続練習日数: 42日（現在進行中）

【ユーザー比較】
あなたの現在地
━━━━━━━━━━━━━━━━━━━━━━━━━━━
上位10%  ────●────────  平均  下位10%
         ▲
       あなた

同期間開始ユーザーの中で上位12%の成績です
```

---

## 📋 実装ロードマップ

### Phase 1: データ活用基盤（2週間）

**Week 1: データ構造設計**
- [ ] IntervalAnalysis型定義・実装
- [ ] BaseNoteAnalysis型定義・実装
- [ ] HistoricalData型定義・実装
- [ ] データ集計エンジン実装
- [ ] localStorage拡張（無制限保存対応）

**Week 2: UI実装**
- [ ] 音程別分析UI実装
- [ ] 基音別習熟度マップUI実装
- [ ] 成長グラフUI実装（Chart.js等）
- [ ] データエクスポート機能（PDF/CSV）

---

### Phase 2: 弱点克服モード（2週間）

**Week 1: 検出エンジン**
- [ ] WeaknessDetection型定義
- [ ] 音程別弱点検出ロジック
- [ ] 基音別弱点検出ロジック
- [ ] 傾向分析ロジック（シャープ/フラット等）
- [ ] 弱点検出UI実装

**Week 2: 克服モード実装**
- [ ] WeaknessOvercomeMode型定義
- [ ] 集中練習モード実装（interval_focus）
- [ ] 集中練習モード実装（basenote_focus）
- [ ] 改善効果測定・可視化
- [ ] 無料版制限実装

---

### Phase 3: プレミアム分析（2週間）

**Week 1: 分析ページ基盤**
- [ ] タブナビゲーション実装
- [ ] 音程精度分析タブUI
- [ ] エラーパターン分析タブUI
- [ ] データ可視化コンポーネント

**Week 2: AI機能**
- [ ] 練習プラン生成ロジック
- [ ] 成長予測アルゴリズム
- [ ] ユーザー比較機能（匿名統計）
- [ ] 成長記録タブUI

---

### Phase 4: 収益化準備（1週間）

**Week 1: 決済・広告統合**
- [ ] Stripe決済統合
- [ ] サブスクリプション管理
- [ ] Google AdSense統合
- [ ] 無料版セッション制限実装
- [ ] プレミアム機能ロック実装
- [ ] 課金状態管理

---

## 🎯 成功指標（KPI）

### ユーザー関連KPI

```typescript
const kpiTargets = {
  // 3ヶ月目標
  month3: {
    monthlyActiveUsers: 1000,
    premiumConversionRate: 0.02,  // 2%
    premiumUsers: 20,
    monthlyRecurringRevenue: 9600  // ¥480 × 20
  },

  // 6ヶ月目標
  month6: {
    monthlyActiveUsers: 3000,
    premiumConversionRate: 0.025, // 2.5%
    premiumUsers: 75,
    monthlyRecurringRevenue: 36000  // ¥480 × 75
  },

  // 12ヶ月目標
  month12: {
    monthlyActiveUsers: 10000,
    premiumConversionRate: 0.03,  // 3%
    premiumUsers: 300,
    monthlyRecurringRevenue: 144000  // ¥480 × 300
  }
};
```

### エンゲージメントKPI

```typescript
const engagementKPIs = {
  retentionRate: {
    day1: 0.60,   // 60%
    day7: 0.30,   // 30%
    day30: 0.15   // 15%
  },

  sessionsPerUser: {
    weekly: 3,     // 週3回
    monthly: 12    // 月12回
  },

  averageSessionDuration: 300,  // 5分

  weaknessModeUsage: 0.80  // プレミアムユーザーの80%が利用
};
```

---

## 📊 競合比較と差別化戦略

### 競合分析

| 機能 | 本アプリ | Perfect Ear | EarMaster | ヤマハ音楽教室 |
|-----|---------|------------|-----------|--------------|
| **相対音感特化** | ✅ | ❌ | △ | ✅ |
| **音域適応型基音** | ✅ | ❌ | ❌ | ✅ |
| **弱点自動検出** | ✅ | ❌ | ❌ | ✅ |
| **弱点克服モード** | ✅ | ❌ | ❌ | ✅ |
| **AI練習プラン** | ✅ | ❌ | ❌ | ✅ |
| **12音律習熟度マップ** | ✅ | ❌ | △ | ✅ |
| **3ヶ月成長グラフ** | ✅ | △ | ✅ | ✅ |
| **月額料金** | ¥480 | ¥600 | ¥1,200 | ¥8,000+ |

### 独自の差別化ポイント

1. **音域適応型基音選択**: 音域テスト結果に基づいた最適な基音提供
2. **弱点克服モード**: 分析結果から自動生成される集中練習プログラム
3. **12音律完全マップ**: クロマチック12音すべての習熟度可視化
4. **圧倒的コストパフォーマンス**: 音楽教室の1/16、競合の半額〜2/3

---

## ✅ 次のステップ

### 即座に開始可能な作業

1. **データ構造定義**: TypeScript型定義ファイル作成
2. **localStorage拡張**: 無制限保存対応
3. **集計エンジン実装**: 音程別・基音別分析ロジック
4. **弱点検出ロジック**: 偏差計算・閾値判定

### ユーザー承認が必要な事項

1. **価格設定の最終確認**: ¥480/月で確定するか
2. **無料版制限の詳細**: 1日3セッションで適切か
3. **B2B展開の優先度**: 教育機関向けライセンスの開発時期

---

**この仕様書は、有料プランの価値検証結果と実装ロードマップを定義したものです。**
**段階的な実装により、確実に収益化可能なプロダクトを構築します。**
