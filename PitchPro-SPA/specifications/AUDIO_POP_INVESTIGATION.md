# 調査報告: ブチ音（ポップノイズ）の継続について

## 現状の分析
「音の揺れ」は解消されましたが、「ブチ音」が依然として発生しているとのこと、承知いたしました。
原因として、以下の3つの可能性が高いと考えられます。

### 1. 音源ファイル（C3.mp3）自体の問題
現在、`reference-tones.js` は **`C3.mp3` のみ** を読み込んで、すべての音程をこれを加工（ピッチシフト）して再生しています。
*   **波形の開始点:** `C3.mp3` の波形が「無音（ゼロ）」から始まっておらず、いきなり振幅がある状態で始まっている場合、アタックタイムを長くしても、MP3のデコード遅延などにより「ブチッ」という音が残る可能性があります。
*   **無音部分:** ファイルの冒頭に微妙な無音部分が含まれている場合、アタック（フェードイン）処理が無音部分に対して行われてしまい、実際の音が鳴り始めるタイミングでは既にフェードインが終わっていて、唐突に音が鳴る（＝ブチ音）現象が起きている可能性があります。

### 2. ピッチシフトによる劣化
現在、`C3`（ド）のサンプル1つで、低い音から高い音まで全てをカバーしています。
*   **音質の劣化:** 原音から離れた音程（例：C2やC5）を再生する場合、波形を無理やり引き伸ばしたり縮めたりするため、ノイズが目立ちやすくなります。
*   **サーバー内のファイル:** 調査の結果、サーバー上には `C2.mp3`, `C4.mp3`, `C5.mp3` も存在していますが、現在は使用されていません（安定性重視のため単一サンプル化された経緯あり）。

### 3. PC環境特有のオーディオ処理
PC（特にWindowsや高性能オーディオI/F）は、モバイル端末よりも高解像度で再生するため、MP3特有の圧縮ノイズや、波形の不連続点が「ブチ音」としてより鮮明に聞こえてしまっている可能性があります。

## 今後の修正案（提案）

### 案A: マルチサンプル化（推奨）
サーバーに存在する `C2.mp3`, `C4.mp3`, `C5.mp3` を活用し、音程に合わせて最適なサンプルを使用するように変更します。
*   **メリット:** ピッチシフト量が減り、音質が劇的に向上します。ブチ音のリスクも分散されます。
*   **デメリット:** 初回ロード時間がわずかに増えます（ファイル数増）。

### 案B: 音源ファイルの再調整（ユーザー様作業）
`C3.mp3` を波形編集ソフトで確認し、以下の加工を行うことで改善する可能性があります。
1.  **冒頭の無音カット:** 波形が始まる直前まで無音を削除する。
2.  **フェードイン処理:** 波形の冒頭数ミリ秒にフェードインを焼き込んでしまう。

### 案C: アタックタイムのさらなる調整
アタックタイムを現在の `0.1秒` から `0.2秒` 程度までさらに伸ばす。
*   **デメリット:** 音の立ち上がりが遅くなり、リズムが取りづらくなる可能性があります。

---

まずは **案A（マルチサンプル化）** を試す価値が高いと考えますが、いかがでしょうか？
指示があるまで修正は行いません。
