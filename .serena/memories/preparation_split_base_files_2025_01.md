# Preparation分割 - ベースファイル情報

## 🎯 提案された解決策
preparation.htmlを**2つの独立したファイルに分ける**ことでPitchPro二重初期化問題を解決

## 📁 ベースとなる完成ファイル

### 1. マイク許可・音声テスト機能（完成版）
**ファイル**: `/Users/isao/Documents/Relative-pitch-app/Bolt/v2/pages/test-pitchpro-cycle.html`
- マイク許可機能
- 音声テスト機能
- PitchPro統合済み
- **動作確認済み**

### 2. 音域テスト機能（完成版）
**ファイル**: `/Users/isao/Documents/Relative-pitch-app/voice-range-test-v4/src/voice-range-test-demo.html`
- 音域テスト機能
- 音域テスト結果表示
- PitchPro統合済み
- **動作確認済み**

## 🔄 分割方針

### preparation-step1.html（マイク許可・音声テスト）
**ベース**: `test-pitchpro-cycle.html`
- マイクロフォン許可取得
- 基本的な音声テスト・音量確認
- localStorage保存
- step2への遷移

### preparation-step2.html（音域テスト・結果）
**ベース**: `voice-range-test-demo.html`
- step1完了チェック
- 音域測定（最低音・最高音）
- 測定結果表示・保存
- training.htmlへの遷移

## ✅ この方法の利点

### 技術的メリット
- **PitchPro二重初期化問題の根本解決**: 各ページで独立したインスタンス
- **動作確認済みコードの活用**: 既存の完成ファイルをベースにするため安全
- **複雑な統合作業の回避**: 新規統合ではなく分離による実装

### 開発効率メリット
- **リスク最小化**: 既に動作するコードをベースにする
- **段階的実装**: 各ページを個別に完成させられる
- **デバッグの容易さ**: 問題の切り分けが簡単

### 保守性メリット
- **単一責任原則**: 各ページが明確な役割を持つ
- **独立性**: 一方の修正が他方に影響しない
- **理解しやすさ**: コードの見通しが良い

## 📋 実装方針
1. 各ベースファイルを読み込んで構造を理解
2. preparation仕様に合わせてUI・フローを調整
3. localStorage連携実装
4. ページ間遷移実装
5. 統合テスト

## 🎯 現実性評価
**非常に現実的**
- 既存の動作確認済みコードを最大活用
- 複雑な統合を避けて確実な実装が可能
- PitchProの技術的制約を根本的に解決

## 記録日
2025年1月28日

## 状態
提案段階 - 実装準備中