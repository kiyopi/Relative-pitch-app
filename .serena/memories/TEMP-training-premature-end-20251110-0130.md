# トレーニング早期終了問題の一時メモ

## 報告された問題（2025-11-10）
1. **音量バーが「ラシド」で止まる** - ログには明確な証拠なし
2. **最後のドを発声中にセッション評価が表示される** - ログで確認済み
3. **セッション評価表示後にリロードが発生** - ユーザー報告

## ログ分析結果
- Line 4: `🎵 音程: ド (+12半音, 期待: 174.6Hz)` - 最後のド開始
- Line 14: `✅ トレーニング完了` - すぐに完了
- **問題**: 最後のステップで700ms待機後、即座にループ終了

## for loopの構造
```javascript
for (let i = 0; i < guideCount; i++) {
    // 各ステップの処理
    await new Promise(resolve => setTimeout(resolve, 700));
}
// ← ここで即座にトレーニング完了
```

## 重要な事実
**ユーザーの指摘**: 「今までは正常に動作していました」
→ **この問題は新しく発生した**
→ 最近の変更（PitchProConfig導入、onVolumeUpdate追加等）が原因の可能性

## 次のステップ
1. 過去のコミットで同じfor loopロジックを確認
2. 以前は何が違ったのかを特定
3. PitchProConfigやonVolumeUpdate追加の影響を調査
