# 相対音感トレーニングアプリ - 評価システム仕様書

**バージョン**: 1.0.0  
**作成日**: 2025-08-07  
**用途**: 音程精度評価・採点システムの詳細仕様

---

## 🎯 評価システム概要

### 基本原理
相対音感トレーニングにおける評価は、**基音に対する相対的な音程の正確さ**を測定します。
各音階（ドレミファソラシド）における周波数の誤差をセント単位で計測し、その精度に基づいて評価を行います。

### 評価の重要性
- **即時フィードバック**: リアルタイムで自分の音程精度を把握
- **成長の可視化**: 練習による上達を数値とグラフで確認
- **モチベーション維持**: 段階的な評価で達成感を提供
- **弱点の特定**: 苦手な音程を明確化し効率的な練習を促進

---

## 📊 評価基準

### 4段階評価システム

#### 🏆 優秀（Excellent）
- **判定基準**: ±15セント以内
- **説明**: 非常に正確な音程。プロレベルに近い精度
- **スコア**: 100点
- **表示色**: ゴールド (#FFD700)
- **アニメーション**: キラキラエフェクト

#### 🎉 良好（Good）
- **判定基準**: ±25セント以内
- **説明**: 良好な精度。実用レベルの音感
- **スコア**: 80点
- **表示色**: グリーン (#51cf66)
- **アニメーション**: パルスエフェクト

#### 👍 合格（Pass）
- **判定基準**: ±40セント以内
- **説明**: 合格レベル。基本的な音感は身についている
- **スコア**: 60点
- **表示色**: ブルー (#4c6ef5)
- **アニメーション**: 軽いバウンス

#### 😭 要練習（Need Practice）
- **判定基準**: ±41セント以上
- **説明**: 練習が必要。基礎から丁寧に
- **スコア**: 30点
- **表示色**: グレー (#868e96)
- **アニメーション**: 振動エフェクト（励まし）

---

## 🎵 個別音階評価

### 評価プロセス

1. **音程検出**
   ```
   検出周波数 → 目標周波数との比較 → セント誤差計算
   ```

2. **セント誤差の計算式**
   ```
   誤差(セント) = 1200 × log2(検出周波数 / 目標周波数)
   ```

3. **個別採点**
   - 各音階（8音）それぞれに対して評価
   - リアルタイム視覚フィードバック提供

### 視覚的フィードバック

#### リアルタイム表示
```
ド: 🏆 +5¢  (優秀)
レ: 🎉 -20¢ (良好)
ミ: 👍 +35¢ (合格)
ファ: 😭 +45¢ (要練習)
```

#### 精度メーター
```
[========|=======] +5セント
    中心が正確な音程
```

---

## 📈 セッション総合評価

### 総合スコア計算

#### 計算方法
```javascript
総合スコア = (個別スコアの合計) / 8音

// 例：
ド(100) + レ(80) + ミ(60) + ファ(30) + ソ(100) + ラ(80) + シ(60) + ド(100)
= 610 / 8 = 76.25点
```

### 総合評価ランク

| ランク | スコア範囲 | 表示 | メッセージ |
|-------|-----------|------|------------|
| S | 95-100 | 🌟 | 完璧！プロレベルの精度です！ |
| A | 85-94 | ⭐ | 素晴らしい！とても正確です |
| B | 75-84 | ✨ | 良好！安定した音感です |
| C | 65-74 | 👏 | 合格！基礎は身についています |
| D | 50-64 | 💪 | もう少し！練習を続けましょう |
| E | 0-49 | 📚 | 基礎から練習しましょう |

---

## 📊 結果表示UI

### 1. 即座表示（各音階完了時）

```
♪ ミ を歌いました
━━━━━━━━━━━━━━━
精度: 🎉 良好
誤差: -18セント
スコア: 80点
```

### 2. セッション完了時の詳細表示

#### 総合結果カード
```
┌─────────────────────────┐
│    🏆 セッション完了！     │
├─────────────────────────┤
│  総合スコア: 76.25       │
│  ランク: B               │
│  精度: 78.5%            │
│  時間: 3:45             │
└─────────────────────────┘
```

#### 詳細グラフ（アニメーション付き）

**棒グラフ表示**
```
100 ┤ ■
 80 ┤ ■ ■     ■   ■
 60 ┤ ■ ■ ■   ■ ■ ■ ■
 40 ┤ ■ ■ ■   ■ ■ ■ ■
 20 ┤ ■ ■ ■ ■ ■ ■ ■ ■
  0 └─────────────────
    ド レ ミ ファ ソ ラ シ ド
```

**レーダーチャート**
```
     ド(100)
      ／＼
    ／    ＼
シ(60)    レ(80)
  │        │
  │    ◆   │
ラ(80)    ミ(60)
    ＼    ／
      ＼／
    ソ(100) ファ(30)
```

### 3. 誤差分布の可視化

**ヒートマップ表示**
```
優秀 [■■■□] 3音
良好 [■■□□] 2音
合格 [■■□□] 2音
要練 [■□□□] 1音
```

**セント誤差の分布図**
```
+40 ┤      ●
+20 ┤   ●     ●
  0 ┤ ●   ●     ●
-20 ┤     ●
-40 ┤         ●
    └─────────────
     ド レ ミ ファ ソ ラ シ ド
```

---

## 🎮 アニメーション仕様

### 評価表示アニメーション

1. **スコア表示**
   - 0から目標値までカウントアップ（1秒）
   - イージング: ease-out

2. **グラフ描画**
   - 左から右へ順次表示（0.5秒/本）
   - 各棒グラフがバウンスしながら出現

3. **ランク表示**
   - スケール0→1でフェードイン
   - 評価に応じたパーティクルエフェクト

4. **改善提案**
   - スライドインで表示
   - 重要ポイントは点滅

---

## 💡 フィードバックメッセージ

### 音階別メッセージ

**優秀な場合**
- 「完璧です！」
- 「素晴らしい音程！」
- 「プロ級の精度！」

**良好な場合**
- 「いい感じ！」
- 「安定しています」
- 「その調子！」

**要練習の場合**
- 「もう少し高く」（フラット時）
- 「もう少し低く」（シャープ時）
- 「リラックスして」

### 総合メッセージ

**高得点時（85点以上）**
```
🌟 素晴らしいパフォーマンス！
この調子で練習を続けましょう。
特に「ド」「ソ」「高いド」が完璧でした！
```

**中得点時（65-84点）**
```
👏 良い音感を持っています！
「ファ」の音程をもう少し練習すると
さらに精度が上がりますよ。
```

**低得点時（65点未満）**
```
💪 練習あるのみ！
まずは「ド」「ミ」「ソ」の
基本3音から始めてみましょう。
一歩ずつ確実に！
```

---

## 📱 レスポンシブ対応

### デスクトップ表示
- グラフとテキスト情報を横並び
- 詳細な数値表示
- 大きなビジュアライゼーション

### タブレット表示（iPad縦向き）
- グラフを上部に配置
- テキスト情報を下部に整理
- タッチ操作に最適化

### モバイル表示
- コンパクトな表示
- 重要情報のみ初期表示
- 「詳細を見る」で展開

---

## 🔄 データ活用

### 練習履歴の活用
- 過去のセッションとの比較
- 成長曲線の表示
- 苦手音程の特定と集中練習提案

### 統計情報
- 平均精度の推移
- 最高記録の更新通知
- 連続練習日数の記録

---

## 🎯 改善提案システム

### 自動分析による提案

**苦手音程の特定**
```
📊 分析結果：
「ファ」の精度が低い傾向があります。
→ ファの音を重点的に練習しましょう
```

**パターン認識**
```
💡 気づき：
高い音程で誤差が大きくなる傾向があります。
→ 呼吸を深くして、リラックスして歌いましょう
```

---

**この評価システムにより、ユーザーは自分の音感レベルを正確に把握し、効率的な練習が可能になります。**