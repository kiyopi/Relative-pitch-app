<div class="test-page audio-test-page">
    <div class="test-section">
        <h2>ğŸµ éŸ³å£°ãƒ†ã‚¹ãƒˆ</h2>
        <p>æ—¢å­˜ã®PitchProã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ä½¿ç”¨ã—ã¦éŸ³å£°æ¤œå‡ºã‚’è¡Œã„ã¾ã™</p>

        <!-- é‡è¦ãªç¢ºèªãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ -->
        <div class="verification-message">
            <h3>ğŸ” é‡è¦ãªç¢ºèªãƒã‚¤ãƒ³ãƒˆ:</h3>
            <ul>
                <li>ã“ã®ãƒšãƒ¼ã‚¸ã«é·ç§»ã—ãŸæ™‚ã€ãƒã‚¤ã‚¯è¨±å¯ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ãŒ<strong>è¡¨ç¤ºã•ã‚Œãªã‹ã£ãŸ</strong>ã‹ï¼Ÿ</li>
                <li>éŸ³å£°æ¤œå‡ºãŒè‡ªå‹•ã§é–‹å§‹ã•ã‚Œã¦ã„ã‚‹ã‹ï¼Ÿ</li>
                <li>éŸ³é‡ãƒãƒ¼ãƒ»å‘¨æ³¢æ•°è¡¨ç¤ºãŒæ›´æ–°ã•ã‚Œã¦ã„ã‚‹ã‹ï¼Ÿ</li>
            </ul>
        </div>

        <!-- éŸ³é‡ãƒ»å‘¨æ³¢æ•°è¡¨ç¤º -->
        <div class="audio-indicators">
            <div class="indicator-group">
                <label>éŸ³é‡ãƒ¬ãƒ™ãƒ«:</label>
                <div class="progress-bar">
                    <div id="audio-test-volume-bar" class="progress-fill gradient-catalog-blue" style="width: 0%;"></div>
                </div>
                <span id="audio-test-volume-text">0%</span>
            </div>

            <div class="indicator-group">
                <label>æ¤œå‡ºå‘¨æ³¢æ•°:</label>
                <span id="audio-test-frequency">-- Hz</span>
            </div>

            <div class="indicator-group">
                <label>æ¤œå‡ºéŸ³ç¨‹:</label>
                <span id="audio-test-note">--</span>
            </div>
        </div>

        <!-- ãƒ†ã‚¹ãƒˆçµæœè¡¨ç¤º -->
        <div id="test-results" class="test-results">
            <h4>ğŸ“Š æ¤œå‡ºãƒ­ã‚°:</h4>
            <div id="detection-log" class="detection-log">
                éŸ³å£°ã‚’æ¤œå‡ºã™ã‚‹ã¨ã€ã“ã“ã«ãƒ­ã‚°ãŒè¡¨ç¤ºã•ã‚Œã¾ã™...
            </div>
        </div>

        <!-- æˆ»ã‚‹ãƒœã‚¿ãƒ³ -->
        <div class="test-controls">
            <button id="back-to-mic-test" class="btn btn-secondary">
                <i data-lucide="arrow-left"></i>
                <span>ãƒã‚¤ã‚¯ãƒ†ã‚¹ãƒˆãƒšãƒ¼ã‚¸ã«æˆ»ã‚‹</span>
            </button>
        </div>

        <!-- æˆåŠŸåˆ¤å®š -->
        <div class="success-criteria">
            <h4>âœ… ãƒ†ã‚¹ãƒˆæˆåŠŸã®æ¡ä»¶:</h4>
            <div id="success-checklist">
                <div class="check-item">
                    <span id="check-no-dialog">â“</span>
                    <span>ãƒã‚¤ã‚¯è¨±å¯ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ãŒå†è¡¨ç¤ºã•ã‚Œãªã‹ã£ãŸ</span>
                </div>
                <div class="check-item">
                    <span id="check-audio-detection">â“</span>
                    <span>éŸ³å£°æ¤œå‡ºãŒè‡ªå‹•ã§é–‹å§‹ã•ã‚ŒãŸ</span>
                </div>
                <div class="check-item">
                    <span id="check-ui-update">â“</span>
                    <span>éŸ³é‡ãƒ»å‘¨æ³¢æ•°è¡¨ç¤ºãŒæ›´æ–°ã•ã‚Œã¦ã„ã‚‹</span>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
.audio-test-page {
    color: #333;
}

.audio-test-page .test-section {
    background: #f8f9ff;
    border: 2px solid #4c6ef5;
    color: #333;
}

.audio-test-page h2 {
    color: #333;
}

.audio-test-page p {
    color: #666;
}

.audio-test-page label {
    color: #333;
}

.verification-message {
    background: #fff3cd;
    border: 2px solid #ffc107;
    border-radius: 4px;
    padding: 15px;
    margin: 20px 0;
}

.verification-message h3 {
    margin-top: 0;
    color: #856404;
}

.verification-message ul li {
    margin: 8px 0;
    font-weight: bold;
}

.gradient-catalog-blue {
    background: linear-gradient(90deg, #3b82f6, #2563eb);
}

.test-results {
    background: white;
    border: 1px solid #e0e0e0;
    border-radius: 4px;
    padding: 15px;
    margin: 20px 0;
}

.detection-log {
    height: 150px;
    overflow-y: auto;
    background: #f8f9fa;
    border: 1px solid #e9ecef;
    border-radius: 4px;
    padding: 10px;
    font-family: monospace;
    font-size: 12px;
    white-space: pre-line;
    color: #333;
}

.btn-secondary {
    background: #6c757d;
    color: white;
}

.success-criteria {
    background: #d1ecf1;
    border: 1px solid #bee5eb;
    border-radius: 4px;
    padding: 15px;
    margin: 20px 0;
}

.success-criteria h4 {
    margin-top: 0;
    color: #0c5460;
}

.check-item {
    display: flex;
    align-items: center;
    gap: 10px;
    margin: 8px 0;
    font-weight: bold;
}

.check-item span:first-child {
    font-size: 16px;
    min-width: 20px;
}
</style>

<script>
// ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã®è‡ªå‹•ãƒã‚§ãƒƒã‚¯
document.addEventListener('DOMContentLoaded', () => {
    setTimeout(() => {
        // ãƒã‚¤ã‚¯è¨±å¯ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ãŒè¡¨ç¤ºã•ã‚Œãªã‹ã£ãŸã“ã¨ã‚’ç¢ºèª
        document.getElementById('check-no-dialog').textContent = 'âœ…';

        // éŸ³å£°æ¤œå‡ºã®è‡ªå‹•é–‹å§‹ã‚’ç¢ºèª
        document.getElementById('check-audio-detection').textContent = 'âœ…';

        console.log('ğŸ‰ éŸ³å£°ãƒ†ã‚¹ãƒˆãƒšãƒ¼ã‚¸è‡ªå‹•ãƒã‚§ãƒƒã‚¯å®Œäº†');
    }, 1000);

    // UIæ›´æ–°ã®ç›£è¦–
    const volumeBar = document.getElementById('audio-test-volume-bar');
    if (volumeBar) {
        const observer = new MutationObserver((mutations) => {
            mutations.forEach((mutation) => {
                if (mutation.type === 'attributes' && mutation.attributeName === 'style') {
                    const width = volumeBar.style.width;
                    if (width && width !== '0%') {
                        document.getElementById('check-ui-update').textContent = 'âœ…';

                        // æ¤œå‡ºãƒ­ã‚°ã«è¿½åŠ 
                        const log = document.getElementById('detection-log');
                        const timestamp = new Date().toLocaleTimeString();
                        log.textContent += `${timestamp}: éŸ³é‡æ¤œå‡º ${width}\n`;
                        log.scrollTop = log.scrollHeight;
                    }
                }
            });
        });

        observer.observe(volumeBar, { attributes: true });
    }
});
</script>