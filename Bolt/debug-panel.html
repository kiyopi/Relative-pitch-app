<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>モード別出力確認デバッグパネル</title>
    <style>
        body {
            font-family: monospace;
            background: #1a1a1a;
            color: #fff;
            padding: 20px;
            margin: 0;
        }
        .container {
            max-width: 1400px;
            margin: 0 auto;
        }
        .mode-selector {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
            padding: 20px;
            background: rgba(255,255,255,0.1);
            border-radius: 10px;
        }
        .mode-btn {
            padding: 10px 20px;
            background: #4a5568;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
        }
        .mode-btn.active {
            background: #3b82f6;
        }
        .output-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }
        .phase-box {
            background: rgba(255,255,255,0.05);
            border: 1px solid rgba(255,255,255,0.2);
            border-radius: 10px;
            padding: 15px;
        }
        .phase-title {
            color: #fbbf24;
            font-size: 18px;
            margin-bottom: 10px;
            border-bottom: 1px solid rgba(255,255,255,0.2);
            padding-bottom: 5px;
        }
        .phase-content {
            white-space: pre-wrap;
            font-size: 14px;
            line-height: 1.6;
        }
        .debug-info {
            background: rgba(0,255,0,0.1);
            border: 1px solid rgba(0,255,0,0.3);
            padding: 10px;
            margin-top: 20px;
            border-radius: 5px;
        }
        .comparison-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 30px;
        }
        .comparison-table th,
        .comparison-table td {
            border: 1px solid rgba(255,255,255,0.2);
            padding: 10px;
            text-align: left;
        }
        .comparison-table th {
            background: rgba(255,255,255,0.1);
            color: #fbbf24;
        }
        .highlight-12 {
            background: rgba(59,130,246,0.2);
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>🔍 モード別Phase内容確認デバッグパネル</h1>
        
        <div class="mode-selector">
            <button class="mode-btn" onclick="loadMode(8)">8セッション（初級）</button>
            <button class="mode-btn active" onclick="loadMode(12)">12セッション（中級）</button>
            <button class="mode-btn" onclick="loadMode(24)">24セッション（上級）</button>
        </div>

        <div class="debug-info">
            <strong>現在のモード:</strong> <span id="current-mode">12セッション</span><br>
            <strong>フォーカス:</strong> <span id="current-focus">📍 12音すべてへの対応力向上度</span><br>
            <strong>12音律分析表示:</strong> <span id="tone-analysis-visible">表示</span>
        </div>

        <h2>Phase 1-5 出力内容</h2>
        <div class="output-grid" id="phase-outputs">
            <!-- JavaScriptで動的に生成 -->
        </div>

        <h2>比較テーブル</h2>
        <table class="comparison-table">
            <thead>
                <tr>
                    <th>Phase</th>
                    <th>8セッション</th>
                    <th class="highlight-12">12セッション（12音特化）</th>
                    <th>24セッション</th>
                </tr>
            </thead>
            <tbody id="comparison-tbody">
                <!-- JavaScriptで動的に生成 -->
            </tbody>
        </table>

        <h2>実際の関数呼び出し結果</h2>
        <div class="phase-box">
            <div class="phase-title">generateDetailedAnalysis()</div>
            <div class="phase-content" id="detailed-analysis-output"></div>
        </div>
        <div class="phase-box">
            <div class="phase-title">generatePracticeGuidance()</div>
            <div class="phase-content" id="practice-guidance-output"></div>
        </div>
    </div>

    <script>
        // モックデータ
        const mockSessionsData = [
            { baseNote: 'C4', session: 1 },
            { baseNote: 'F#4', session: 2 },
            { baseNote: 'D4', session: 3 },
            { baseNote: 'G#4', session: 4 },
            { baseNote: 'E4', session: 5 },
            { baseNote: 'A#4', session: 6 },
            { baseNote: 'F4', session: 7 },
            { baseNote: 'B4', session: 8 },
            { baseNote: 'C#4', session: 9 },
            { baseNote: 'D#4', session: 10 },
            { baseNote: 'A4', session: 11 },
            { baseNote: 'G4', session: 12 }
        ];

        // Phase内容の定義（現在の実装）
        const phaseContent = {
            8: {
                phase1: "ピンポイント分析（基本音程）",
                phase2: "セッション別パフォーマンス",
                phase3: "音階別弱点（ドレミファソラシド）",
                phase4: "時系列学習曲線",
                phase5: "基本音程パターン分析",
                focus: "基本的な音程感覚の定着度"
            },
            12: {
                phase1: "ピンポイント分析（12音）❌ 未特化",
                phase2: "セッション別パフォーマンス ❌ 未特化",
                phase3: "12音別弱点ランキング ✅",
                phase4: "時系列パフォーマンス ❌ 未特化",
                phase5: "相対音感パターン分析 ⚠️ 部分対応",
                focus: "📍 12音すべてへの対応力向上度"
            },
            24: {
                phase1: "ピンポイント分析（プロレベル）",
                phase2: "セッション別パフォーマンス（詳細）",
                phase3: "全音域弱点マップ",
                phase4: "長期習熟曲線分析",
                phase5: "完璧な12音律システム分析",
                focus: "プロレベルの完璧な12音律システム習得度"
            }
        };

        // 理想的な12音特化内容
        const ideal12ToneContent = {
            phase1: "半音階間隔の困難度分析",
            phase2: "12音システム理解度評価",
            phase3: "12音別弱点ランキング",
            phase4: "クロマチック習熟曲線",
            phase5: "12音相対音感パターン"
        };

        function loadMode(sessionCount) {
            // ボタンのアクティブ状態更新
            document.querySelectorAll('.mode-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');

            // デバッグ情報更新
            document.getElementById('current-mode').textContent = `${sessionCount}セッション`;
            document.getElementById('current-focus').textContent = phaseContent[sessionCount].focus;
            document.getElementById('tone-analysis-visible').textContent = sessionCount >= 12 ? '表示' : '非表示';

            // Phase出力更新
            const outputGrid = document.getElementById('phase-outputs');
            outputGrid.innerHTML = '';
            
            for (let i = 1; i <= 5; i++) {
                const phaseBox = document.createElement('div');
                phaseBox.className = 'phase-box';
                if (sessionCount === 12) {
                    phaseBox.style.border = '2px solid #3b82f6';
                }
                phaseBox.innerHTML = `
                    <div class="phase-title">Phase ${i}</div>
                    <div class="phase-content">${phaseContent[sessionCount][`phase${i}`]}</div>
                    ${sessionCount === 12 && ideal12ToneContent[`phase${i}`] ? 
                        `<div style="color: #22c55e; margin-top: 10px;">
                            理想: ${ideal12ToneContent[`phase${i}`]}
                        </div>` : ''}
                `;
                outputGrid.appendChild(phaseBox);
            }

            // 実際の関数出力をシミュレート
            simulateFunctionOutputs(sessionCount);
        }

        function simulateFunctionOutputs(sessionCount) {
            // generateDetailedAnalysis相当
            let detailedAnalysis = '';
            if (sessionCount === 8) {
                detailedAnalysis = "ランダム基音モードでは自然な音階（ドレミファソラシ）の定着度が重要です。";
            } else if (sessionCount === 12) {
                detailedAnalysis = "連続チャレンジモードでは半音を含む12音への適応力が試されています。";
            } else {
                detailedAnalysis = "12音階モードでは完璧な12音律システムの習得が求められます。";
            }
            document.getElementById('detailed-analysis-output').textContent = detailedAnalysis;

            // generatePracticeGuidance相当
            let practiceGuidance = '';
            if (sessionCount === 8) {
                practiceGuidance = "推奨練習: ドレミファソラシドの基本音階を楽器と合わせて歌う練習を重点的に。";
            } else if (sessionCount === 12) {
                practiceGuidance = "推奨練習: 半音階（クロマチック）練習で#♭音程への適応力を向上させましょう。";
            } else {
                practiceGuidance = "推奨練習: 12音律システムの完全習得と長期記憶の定着を目指した集中練習。";
            }
            document.getElementById('practice-guidance-output').textContent = practiceGuidance;
        }

        // 初期表示
        loadMode(12);

        // 比較テーブル生成
        const tbody = document.getElementById('comparison-tbody');
        for (let i = 1; i <= 5; i++) {
            const row = document.createElement('tr');
            row.innerHTML = `
                <td><strong>Phase ${i}</strong></td>
                <td>${phaseContent[8][`phase${i}`]}</td>
                <td class="highlight-12">${phaseContent[12][`phase${i}`]}</td>
                <td>${phaseContent[24][`phase${i}`]}</td>
            `;
            tbody.appendChild(row);
        }
    </script>
</body>
</html>